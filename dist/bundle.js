(()=>{"use strict";var t={844:(t,e,i)=>{i.r(e),i.d(e,{Animation:()=>Ae,Animator:()=>Te,AudioPlayer:()=>Fe,BallCollider:()=>ye,BoxCollider:()=>fe,BroadPhaseMethods:()=>Bt,Button:()=>Ie,ButtonType:()=>te,Camera:()=>de,CollisionMethods:()=>Lt,Component:()=>b,EdgeCollider:()=>Me,Game:()=>oe,GameCamera:()=>ue,GameObject:()=>le,GamepadController:()=>L,GamepadData:()=>U,KeyboardController:()=>V,LAYER_DEFAULT:()=>he,MaskRenderer:()=>je,MouseController:()=>k,PhysicsComponent:()=>C,PolygonCollider:()=>ge,PolygonColliderRenderer:()=>me,PreRenderComponent:()=>j,Rectangle:()=>o,RigidBody:()=>ae,RigidBodyType:()=>Ut,Rotation:()=>d,Scene:()=>pe,SpacePointer:()=>Le,Sprite:()=>Be,SpriteRenderer:()=>Ce,TextOrientation:()=>yt,TextRenderer:()=>_e,TiledTilemapRenderer:()=>Oe,TilemapCollider:()=>xe,TilemapOrientation:()=>T,TilemapRenderer:()=>Se,TouchController:()=>z,Transform:()=>re,Vector2:()=>s,VideoRenderer:()=>Re,between:()=>c,clamp:()=>r,fixedRound:()=>h,randomFloat:()=>a,randomInt:()=>n,range:()=>l});class s{constructor(t=0,e=0){this._x=t,this._y=e}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}get magnitude(){return Math.sqrt(Math.pow(this._x,2)+Math.pow(this._y,2))}set(t,e){this._x=t,this._y=e}copy(t){this.set(t.x,t.y)}equals(t){return this._x===t.x&&this._y===t.y}clone(){return new s(this._x,this._y)}distance(t){return Math.sqrt(Math.pow(this._x-t.x,2)+Math.pow(this._y-t.y,2))}static add(t,e,i){return t.set(e.x+i.x,e.y+i.y),t}static subtract(t,e,i){return t.set(e.x-i.x,e.y-i.y),t}static unit(t,e){return 0===e.magnitude?t.set(0,0):t.set(e.x/e.magnitude,e.y/e.magnitude),t}static normal(t,e){return t.set(-e.y,e.x),this.unit(t,t)}static scale(t,e,i){return t.set(e.x*i,e.y*i),t}static dot(t,e){return t.x*e.x+t.y*e.y}static cross(t,e){return t.x*e.y-t.y*e.x}static round(t,e){return t.set(Math.round(e.x),Math.round(e.y)),t}}class o{constructor(t,e,i,o){this._position=new s,this._center=new s,this._width=0,this._height=0,this.set(t,e,i,o)}get x(){return this._position.x}set x(t){this._position.set(t,this._position.y)}get y(){return this._position.y}set y(t){this._position.set(this._position.x,t)}get x1(){return this._position.x+this._width}get y1(){return this._position.y+this._height}get position(){return this._position}set position(t){this._position.set(t.x,t.y)}get width(){return this._width}set width(t){this._width=t}get height(){return this._height}set height(t){this._height=t}get center(){return this._center.set(this.x+this.width/2,this.y+this.height/2),this._center}set(t,e,i,s){this._position.set(t,e),this._width=i,this._height=s}equals(t){return this.position.equals(t.position)&&this.width===t.width&&this.height===t.height}copy(t){this.set(t.x,t.y,t.width,t.height)}overlaps(t){return this.x1>=t.x&&this.x<t.x1&&this.y1>=t.y&&this.y<t.y1}contains(t){return t instanceof o?t.x1<=this.x1&&t.x>=this.x&&t.y1<=this.y1&&t.y>=this.y:t instanceof s&&!(t.x<this.x||t.y<this.y||t.x>=this.x1||t.y>=this.y1)}}const r=(t,e,i)=>Math.min(i,Math.max(e,t)),n=(t,e)=>Math.round(Math.random()*(e-t))+t,a=(t,e,i=2)=>h(Math.random()*(e-t)+t,i),h=(t,e)=>Math.round(t*Math.pow(10,e))/Math.pow(10,e),l=(t,e,i=1)=>{const s=[];for(let o=t;o<=e;o+=i)s.push(o);return s},c=(t,e,i)=>t>=e&&t<=i;class d{constructor(t=null,e=null){this._degrees=0,this._radians=0,this._direction=new s,t?this.radians=t:e&&(this.degrees=e)}set degrees(t){this._degrees=t,this._radians=t*Math.PI/180,this.updateDirection()}get degrees(){return this._degrees}set radians(t){this._radians=t,this._degrees=180*t/Math.PI,this.updateDirection()}get radians(){return this._radians}get direction(){return this._direction}updateDirection(){this._direction.set(Math.cos(this._radians),Math.sin(this._radians))}}var u=function(t,e){return u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},u(t,e)};function p(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var g,m=function(){return m=Object.assign||function(t){for(var e,i=1,s=arguments.length;i<s;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},m.apply(this,arguments)};function f(t,e,i){if(i||2===arguments.length)for(var s,o=0,r=e.length;o<r;o++)!s&&o in e||(s||(s=Array.prototype.slice.call(e,0,o)),s[o]=e[o]);return t.concat(s||Array.prototype.slice.call(e))}"function"==typeof SuppressedError&&SuppressedError,function(t){t[t.Init=0]="Init",t[t.Start=1]="Start",t[t.Update=2]="Update",t[t.UpdateEngine=3]="UpdateEngine",t[t.UpdateCollider=4]="UpdateCollider",t[t.UpdatePhysics=5]="UpdatePhysics",t[t.UpdateTransform=6]="UpdateTransform",t[t.UpdatePreRender=7]="UpdatePreRender",t[t.UpdateCamera=8]="UpdateCamera",t[t.UpdateRender=9]="UpdateRender",t[t.Destroy=10]="Destroy",t[t.StopGame=11]="StopGame"}(g||(g={}));var y,v=function(){function t(t,e,i,s,o,r,n){this.timeManager=t,this.physicsManager=e,this.renderManager=i,this.inputManager=s,this.gameObjectManager=o,this.sceneManager=r,this.canvasColor=n,this.running=!1,this.gameLoopAccumulator=0,this.gameObjects=[],this.components=[]}return t.prototype.start=function(){this.startLoop(!0)},t.prototype.pause=function(){this.running=!1},t.prototype.resume=function(){this.startLoop(!1)},t.prototype.stop=function(){this.running=!1,this.sceneManager.stopGame(),this.physicsManager.clear(),this.renderManager.clearScreen(this.canvasColor)},t.prototype.startLoop=function(t){this.running||(this.running=!0,t&&this.sceneManager.loadOpeningScene(),this.requestAnimationLoop(window.performance.now()),this.timeManager.gameFramerate!==this.timeManager.physicsFramerate&&this.asyncPhysicsLoop())},t.prototype.requestAnimationLoop=function(t){var e=this;this.running&&(this.timeManager.updateForBrowser(.001*t),this.gameLoopAccumulator+=this.timeManager.browserDeltaTime,this.gameLoopAccumulator>=this.timeManager.minGameDeltatime&&(this.gameLogicIteration(.001*t),this.gameLoopAccumulator-=this.timeManager.minGameDeltatime),this.renderIteration(),window.requestAnimationFrame((function(t){return e.requestAnimationLoop(t)})))},t.prototype.gameLogicIteration=function(t){this.timeManager.updateForGame(t),this.load(),this.dispatchFrameEvent(g.Start),this.inputManager.update(),this.dispatchFrameEvent(g.Update),this.dispatchFrameEvent(g.UpdateEngine),this.dispatchFrameEvent(g.UpdateTransform),this.timeManager.gameFramerate===this.timeManager.physicsFramerate&&(this.timeManager.updateForPhysics(t),this.physicsIteration()),this.dispatchFrameEvent(g.UpdatePreRender),this.sceneManager.update()},t.prototype.renderIteration=function(){this.dispatchFrameEvent(g.UpdatePreRender),this.dispatchFrameEvent(g.UpdateCamera),this.dispatchFrameEvent(g.UpdateRender),this.renderManager.clearScreen(this.canvasColor),this.renderManager.render(),this.renderManager.clearData()},t.prototype.physicsIteration=function(){this.timeManager.timeScale<=0||(this.dispatchFrameEvent(g.UpdatePhysics),this.dispatchFrameEvent(g.UpdateCollider),this.dispatchFrameEvent(g.UpdateTransform),this.physicsManager.resolve(this.timeManager.physicsDeltaTime))},t.prototype.asyncPhysicsLoop=function(){var t=this;this.physicsIntervalId=window.setInterval((function(){if(!t.running)return window.clearInterval(t.physicsIntervalId);t.timeManager.updateForPhysics(.001*window.performance.now()),document.hidden||t.physicsIteration()}),1e3/this.timeManager.physicsFramerate)},t.prototype.load=function(){this.currentScene=this.sceneManager.getCurrentScene(),this.gameObjects=this.gameObjectManager.findGameObjects().filter((function(t){return t.active})),this.components=this.gameObjects.reduce((function(t,e){return f(f([],t,!0),e.getComponents().filter((function(t){return t.active})),!0)}),[])},t.prototype.dispatchFrameEvent=function(t){t!==g.Start&&t!==g.Update||(this.currentScene.dispatch(t),this.gameObjects.filter((function(t){return t.active})).forEach((function(e){return e.dispatch(t)}))),this.components.filter((function(t){return t.active})).forEach((function(e){return e.dispatch(t)}))},t}(),x=function(){function t(t){this.updateEvent=g.Update,this.started=!1,this.container=t,this.gameConfig=this.container.getConstant("GameConfig"),this.gameConfig.headless||(this.assetManager=this.container.getSingleton("AssetManager"),this.domManager=this.container.getSingleton("DomManager"),this.inputManager=this.container.getSingleton("InputManager"),this.renderManager=this.container.getSingleton("RenderManager")),this.gameObjectManager=this.container.getSingleton("GameObjectManager"),this.physicsManager=this.container.getSingleton("PhysicsManager"),this.sceneManager=this.container.getSingleton("SceneManager"),this.timeManager=this.container.getSingleton("TimeManager")}return t.prototype.dispatch=function(t,e){t===g.Init&&this.init?this.init(e):t!==g.Start||this.started?t===this.updateEvent&&this.started&&this.update?this.update():t===g.Destroy?(this.onDestroy&&this.onDestroy(),this._destroy()):t===g.StopGame&&(this.onDestroy&&this.onDestroy(),this._stopGame()):(this.start&&this.start(),this.started=!0)},t.prototype.addGameObject=function(t,e,i){return"string"==typeof e&&(i=e,e={}),this.gameObjectManager.addGameObject(t,e,void 0,i)},t.prototype.findGameObjects=function(t){return t?this.gameObjectManager.findGameObjects(t):this.gameObjectManager.findGameObjects()},t.prototype.findGameObject=function(t){return this.gameObjectManager.findGameObject(t)},t.prototype.findGameObjectsByTag=function(t){return this.gameObjectManager.findGameObjectsByTag(t)},t.prototype.destroyGameObject=function(t){this.gameObjectManager.destroyGameObject(t)},t}(),b=function(t){function e(e,i,s){void 0===s&&(s="");var o=t.call(this,e)||this;return o.allowMultiple=!0,o._active=!0,o.gameObject=i,o.name=s,o}return p(e,t),Object.defineProperty(e.prototype,"active",{get:function(){return this._active},set:function(t){this._active!==t&&(this._active=t,this.onActiveChange())},enumerable:!1,configurable:!0}),e.prototype.onActiveChange=function(){},e.prototype.getCurrentScene=function(){return this.sceneManager.getCurrentScene()},e.prototype.getGameObject=function(){return this.gameObject},e.prototype.getComponents=function(t){return t?this.gameObject.getComponents(t):this.gameObject.getComponents()},e.prototype.getComponent=function(t){return this.gameObject.getComponent(t)},e.prototype.hasComponent=function(t){return this.gameObject.hasComponent(t)},e.prototype.removeComponent=function(t){this.gameObject.removeComponent(t)},e.prototype._destroy=function(){var t=this;Object.keys(this).forEach((function(e){return delete t[e]}))},e.prototype._stopGame=function(){},e}(x),M=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.updateEvent=g.UpdateEngine,e}return p(e,t),e}(b),w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.updateEvent=g.UpdateCollider,e}return p(e,t),e}(b),C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.updateEvent=g.UpdatePhysics,e}return p(e,t),e}(b),_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.updateEvent=g.UpdateTransform,e}return p(e,t),e}(b),j=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.updateEvent=g.UpdatePreRender,e}return p(e,t),e}(b),P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.updateEvent=g.UpdateCamera,e}return p(e,t),e}(b),R=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.updateEvent=g.UpdateRender,e}return p(e,t),e}(b);!function(t){t.Image="Image",t.Audio="Audio",t.Font="Font",t.Video="Video"}(y||(y={}));var O,S,A,T,E,D=function(){function t(t){this.renderManager=t,this.assets=[]}return t.prototype.getAssetsLoaded=function(){return this.assets.reduce((function(t,e){return t&&e.loaded}),!0)},t.prototype.loadImage=function(t,e){var i=this;void 0===e&&(e=!1);var s=new Image;s.crossOrigin="",s.src=t;var o=this.createAsset(t,y.Image,s),r=function(){e&&i.renderManager.preloadTexture(s),o.loaded=!0};return s.naturalWidth?r():s.addEventListener("load",r),s},t.prototype.loadAudio=function(t){var e=new Audio;e.src=t;var i=this.createAsset(t,y.Audio,e);return e.duration?i.loaded=!0:e.addEventListener("canplaythrough",(function(){return i.loaded=!0})),e},t.prototype.loadFont=function(t,e){var i=new FontFace(t,"url(".concat(e,")")),s=this.createAsset(e,y.Font,i);return s.family=t,i.load().then((function(t){document.fonts.add(t),s.loaded=!0})),i},t.prototype.loadVideo=function(t){var e=document.createElement("video");e.playsInline=!0,e.src=t;var i=this.createAsset(t,y.Video,e);return e.duration?i.loaded=!0:e.addEventListener("canplaythrough",(function(){return i.loaded=!0})),e},t.prototype.getImage=function(t){var e;return null===(e=this.assets.find((function(e){return e.type===y.Image&&e.url===t})))||void 0===e?void 0:e.element},t.prototype.getAudio=function(t){var e;return null===(e=this.assets.find((function(e){return e.type===y.Audio&&e.url===t})))||void 0===e?void 0:e.element},t.prototype.getFont=function(t){var e;return null===(e=this.assets.find((function(e){return e.type===y.Font&&e.family===t})))||void 0===e?void 0:e.element},t.prototype.getVideo=function(t){var e;return null===(e=this.assets.find((function(e){return e.type===y.Video&&e.url===t})))||void 0===e?void 0:e.element},t.prototype.createAsset=function(t,e,i){var s={type:e,url:t,element:i,loaded:!1};return this.assets.push(s),s},t}(),F=function(t){function e(e){var i=t.call(this,e)||this;return i.name="AngryPixelException",i}return p(e,t),e}(Error),B=function(){function t(t,e,i){if(this._canvas=null,!t)throw new F("containerNode cannot be empty or null.");this.containerNode=t,this.gameWidth=e,this.gameHeight=i,this.setupCanvas()}return Object.defineProperty(t.prototype,"canvas",{get:function(){return this._canvas},enumerable:!1,configurable:!0}),t.prototype.setupCanvas=function(){this._canvas=document.createElement("canvas"),this._canvas.id="angryPixelGameCanvas",this._canvas.width=Math.floor(this.gameWidth),this._canvas.height=Math.floor(this.gameHeight),this.canvas.tabIndex=0,this._canvas.addEventListener("contextmenu",(function(t){return t.preventDefault()})),this.containerNode.appendChild(this._canvas),this.canvas.focus()},t}(),I=function(){function t(t){this.container=t,this.gameObjects=[]}return t.prototype.addGameObject=function(t,e,i,s){var o=new t(this.container,this.gameObjects.length+1,s,i);return this.gameObjects.push(o),o.dispatch(g.Init,e),o},t.prototype.findGameObjects=function(t){return t?this.gameObjects.filter((function(e){return e instanceof t})):f([],this.gameObjects,!0)},t.prototype.findGameObjectById=function(t){return this.gameObjects.find((function(e){return e.id===t}))},t.prototype.findGameObject=function(t){return"string"==typeof t?this.gameObjects.find((function(e){return e.name===t})):this.gameObjects.find((function(e){return e instanceof t}))},t.prototype.findGameObjectsByParent=function(t){return this.gameObjects.filter((function(e){return e.parent===t}))},t.prototype.findGameObjectByParent=function(t,e){return"string"==typeof e?this.gameObjects.find((function(i){return i.name===e&&i.parent===t})):this.gameObjects.find((function(i){return i instanceof e&&i.parent===t}))},t.prototype.findGameObjectsByTag=function(t){return this.gameObjects.filter((function(e){return e.tag===t}))},t.prototype.destroyAllGameObjects=function(t){var e=this;void 0===t&&(t=!1),this.gameObjects.filter((function(e){return t||!e.keep})).forEach((function(t){return e.destroy(t,!1)}))},t.prototype.destroyGameObject=function(t){this.destroy(t,!0)},t.prototype.destroy=function(t,e){var i=this.gameObjects.indexOf(t);if(-1!==i){var s=this.gameObjects.splice(i,1)[0];e&&this.destroyChildren(s),s.dispatch(g.Destroy)}},t.prototype.destroyChildren=function(t){var e=this;this.findGameObjectsByParent(t).forEach((function(t){return e.destroyGameObject(t)}))},t}(),L=function(){function t(){var t=this;this.gamepads=new Map,this.eventHandler=function(e){"gamepadconnected"===e.type?t.gamepadConnected(e.gamepad):"gamepaddisconnected"===e.type&&t.gamepadDisconected(e.gamepad)},window.addEventListener("gamepadconnected",this.eventHandler),window.addEventListener("gamepaddisconnected",this.eventHandler)}return t.prototype.getGamepad=function(t){var e;return null!==(e=this.gamepads.get(t))&&void 0!==e?e:null},t.prototype.gamepadConnected=function(t){this.gamepads.set(t.index,new U),this.gamepads.get(t.index).updateFromGamepad(t)},t.prototype.gamepadDisconected=function(t){this.gamepads.delete(t.index)},t.prototype.update=function(){for(var t=0,e=this.getGamepads();t<e.length;t++){var i=e[t];null!==i&&(!1===this.gamepads.has(i.index)&&this.gamepadConnected(i),this.gamepads.get(i.index).updateFromGamepad(i))}},t.prototype.getGamepads=function(){return navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[]},t}(),U=function(){function t(){this.buttons=new Map,this.axes=new Map,this._dpadAxes=new s,this._leftStickAxes=new s,this._rightStickAxes=new s,this._vibrating=!1}return t.prototype.updateFromGamepad=function(t){var e=this;this._gamepad=t,t.buttons.forEach((function(t,i){return e.buttons.set(i,t.pressed)})),t.axes.forEach((function(t,i){return e.axes.set(i,t)}))},Object.defineProperty(t.prototype,"id",{get:function(){return this._gamepad.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"connected",{get:function(){return this._gamepad.connected},enumerable:!1,configurable:!0}),t.prototype.getButtonPressed=function(t){return this.buttons.get(t)},t.prototype.getAxis=function(t){return this.axes.get(t)},Object.defineProperty(t.prototype,"dpadAxes",{get:function(){return this._dpadAxes.set(this.dpadRight?1:this.dpadLeft?-1:0,this.dpadUp?1:this.dpadDown?-1:0),this._dpadAxes},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leftStickAxes",{get:function(){return this._leftStickAxes.set(this.leftStickHorizontal,this.leftStickVertical),this._leftStickAxes},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rightStickAxes",{get:function(){return this._rightStickAxes.set(this.rightStickHorizontal,this.rightStickVertical),this._rightStickAxes},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dpadUp",{get:function(){var t;return null!==(t=this.buttons.get(12))&&void 0!==t&&t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dpadDown",{get:function(){var t;return null!==(t=this.buttons.get(13))&&void 0!==t&&t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dpadLeft",{get:function(){var t;return null!==(t=this.buttons.get(14))&&void 0!==t&&t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dpadRight",{get:function(){var t;return null!==(t=this.buttons.get(15))&&void 0!==t&&t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottomFace",{get:function(){var t;return null!==(t=this.buttons.get(0))&&void 0!==t&&t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rightFace",{get:function(){var t;return null!==(t=this.buttons.get(1))&&void 0!==t&&t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leftFace",{get:function(){var t;return null!==(t=this.buttons.get(2))&&void 0!==t&&t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"topFace",{get:function(){var t;return null!==(t=this.buttons.get(3))&&void 0!==t&&t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leftShoulder",{get:function(){var t;return null!==(t=this.buttons.get(4))&&void 0!==t&&t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rightShoulder",{get:function(){var t;return null!==(t=this.buttons.get(5))&&void 0!==t&&t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leftTrigger",{get:function(){var t;return null!==(t=this.buttons.get(6))&&void 0!==t&&t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rightTrigger",{get:function(){var t;return null!==(t=this.buttons.get(7))&&void 0!==t&&t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"back",{get:function(){var t;return null!==(t=this.buttons.get(8))&&void 0!==t&&t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"start",{get:function(){var t;return null!==(t=this.buttons.get(9))&&void 0!==t&&t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leftStickButton",{get:function(){var t;return null!==(t=this.buttons.get(10))&&void 0!==t&&t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rightStickButton",{get:function(){var t;return null!==(t=this.buttons.get(11))&&void 0!==t&&t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leftStickHorizontal",{get:function(){var t;return null!==(t=this.axes.get(0))&&void 0!==t?t:0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leftStickVertical",{get:function(){var t;return null!==(t=-this.axes.get(1))&&void 0!==t?t:0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rightStickHorizontal",{get:function(){var t;return null!==(t=this.axes.get(2))&&void 0!==t?t:0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rightStickVertical",{get:function(){var t;return null!==(t=-this.axes.get(3))&&void 0!==t?t:0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"anyButtonPressed",{get:function(){var t;return null!==(t=Array.from(this.buttons.values()).find((function(t){return t})))&&void 0!==t&&t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"vibrating",{get:function(){return this._vibrating},enumerable:!1,configurable:!0}),t.prototype.vibrate=function(t,e,i,s){var o=this;void 0===t&&(t=200),void 0===e&&(e=.2),void 0===i&&(i=.2),void 0===s&&(s=0),this._gamepad.vibrationActuator&&(this._vibrating=!0,this._gamepad.vibrationActuator.playEffect(this._gamepad.vibrationActuator.type,{duration:t,weakMagnitude:e,strongMagnitude:i,startDelay:s}).catch((function(){return o._vibrating=!1})).finally((function(){return o._vibrating=!1})))},t}(),G=function(){function t(t,e,i,s){this.mouse=t,this.keyboard=e,this.gamepad=i,this.touch=s}return t.prototype.update=function(){this.mouse.update(),this.gamepad.update()},t}(),V=function(){function t(t){var e=this;this.pressedKeys=[],this.keyMap=new Map,this.eventHandler=function(t){if("keydown"===t.type&&(e.keyMap.set(t.code,!0),e.pressedKeys.includes(t.code)||e.pressedKeys.push(t.code)),"keyup"===t.type){e.keyMap.set(t.code,!1);var i=e.pressedKeys.indexOf(t.code);-1!==i&&e.pressedKeys.splice(i,1)}},t.addEventListener("keydown",this.eventHandler),t.addEventListener("keyup",this.eventHandler)}return t.prototype.isPressed=function(t){var e;return null!==(e=this.keyMap.get(t))&&void 0!==e&&e},t.prototype.orPressed=function(t){var e=this;return t.reduce((function(t,i){var s;return t||null!==(s=e.keyMap.get(i))&&void 0!==s&&s}),!1)},t.prototype.andPressed=function(t){var e=this;return t.reduce((function(t,i){var s;return t&&null!==(s=e.keyMap.get(i))&&void 0!==s&&s}),!0)},t.prototype.isPressedReturn=function(t,e,i){return this.keyMap.get(t)?e:i},t.prototype.orPressedReturn=function(t,e,i){var s=this;return t.reduce((function(t,e){var i;return t||null!==(i=s.keyMap.get(e))&&void 0!==i&&i}),!1)?e:i},t.prototype.andPressedReturn=function(t,e,i){var s=this;return t.reduce((function(t,e){var i;return t&&null!==(i=s.keyMap.get(e))&&void 0!==i&&i}),!0)?e:i},t}(),k=function(){function t(t){this._leftButtonPressed=!1,this._scrollButtonPressed=!1,this._rightButtonPressed=!1,this._positionInViewport=new s(0,0),this._hasMoved=!1,this.lastPositionInViewport=new s(0,0),this.canvas=t,this.setup()}return Object.defineProperty(t.prototype,"leftButtonPressed",{get:function(){return this._leftButtonPressed},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scrollButtonPressed",{get:function(){return this._scrollButtonPressed},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rightButtonPressed",{get:function(){return this._rightButtonPressed},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"positionInViewport",{get:function(){return this._positionInViewport},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasMoved",{get:function(){return this._hasMoved},enumerable:!1,configurable:!0}),t.prototype.update=function(){!1===this._positionInViewport.equals(this.lastPositionInViewport)?(this._hasMoved=!0,this.lastPositionInViewport.copy(this._positionInViewport)):this._hasMoved=!1},t.prototype.setup=function(){var t=this;this.canvas.addEventListener("mousemove",(function(e){return t.updatePosition(e)})),this.canvas.addEventListener("mousedown",(function(e){return t.updateButtonDown(e)})),this.canvas.addEventListener("mouseup",(function(e){return t.updateButtonUp(e)}))},t.prototype.updateButtonDown=function(t){this.canvas.focus(),t.preventDefault(),t.stopPropagation(),this._leftButtonPressed=0===t.button,this._scrollButtonPressed=1===t.button,this._rightButtonPressed=2===t.button},t.prototype.updateButtonUp=function(t){t.preventDefault(),t.stopPropagation(),this._leftButtonPressed=0!==t.button&&this._leftButtonPressed,this._scrollButtonPressed=1!==t.button&&this._scrollButtonPressed,this._rightButtonPressed=2!==t.button&&this._rightButtonPressed},t.prototype.updatePosition=function(t){t.preventDefault(),t.stopPropagation(),this._positionInViewport.set(t.offsetX/(this.canvas.clientWidth/this.canvas.width)-this.canvas.width/2,-t.offsetY/(this.canvas.clientHeight/this.canvas.height)+this.canvas.height/2)},t}(),W=function(){function t(t,e){this.container=t,this.renderManager=e,this.scenes=new Map,this.currentScene=null,this.openingSceneName=null,this.sceneToLoad=null}return t.prototype.getCurrentScene=function(){return this.currentScene},t.prototype.addScene=function(t,e,i,s){var o=this;if(void 0===s&&(s=!1),this.scenes.has(e))throw new F("There is already a scene with the name '".concat(e,"'"));this.scenes.set(e,(function(){var s=new t(o.container,e,o.container.getConstant("Game"));return o.currentScene=s,s.dispatch(g.Init,i),s})),!0!==s&&null!==this.openingSceneName||(this.openingSceneName=e)},t.prototype.loadOpeningScene=function(){if(null===this.openingSceneName)throw new F("There is no opening scene");this._loadScene(this.openingSceneName)},t.prototype.loadScene=function(t){if(!1===this.scenes.has(t))throw new F("Scene with name ".concat(t," does not exists"));this.sceneToLoad=t},t.prototype.update=function(){null!==this.sceneToLoad&&(this._loadScene(this.sceneToLoad),this.sceneToLoad=null)},t.prototype._loadScene=function(t){this.unloadCurrentScene(),this.scenes.get(t)()},t.prototype.unloadCurrentScene=function(){null!==this.currentScene&&(this.currentScene.dispatch(g.Destroy),this.currentScene=null,this.currentSceneName=null,this.renderManager&&this.renderManager.clearData())},t.prototype.stopGame=function(){null!==this.currentScene&&(this.currentScene.dispatch(g.StopGame),this.currentScene=null,this.currentSceneName=null,this.renderManager&&this.renderManager.clearData())},t}(),Y=[60,120,180,240],H=function(){function t(t){if(this.minGameDeltatime=0,this.minPhysicsDeltaTime=0,this.gameFramerate=60,this.physicsFramerate=180,this.timeScale=1,this.browserDeltaTime=0,this.unscaledDeltaTime=0,this.unscaledPhysicsDeltaTime=0,this.maxDeltaTime=1/30,this.thenForGame=0,this.thenForPhysics=0,this.thenForBrowser=0,!Y.includes(t))throw new F("Invalid Physics frame rate. Allowed: [".concat(Y.join(", "),"]"));this.physicsFramerate=t,this.minGameDeltatime=parseFloat((1/this.gameFramerate).toFixed(6)),this.minPhysicsDeltaTime=parseFloat((1/this.physicsFramerate).toFixed(6))}return Object.defineProperty(t.prototype,"deltaTime",{get:function(){return this.unscaledDeltaTime*this.timeScale},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"physicsDeltaTime",{get:function(){return this.unscaledPhysicsDeltaTime*this.timeScale},enumerable:!1,configurable:!0}),t.prototype.updateForGame=function(t){this.unscaledDeltaTime=Math.min(Math.max(this.minGameDeltatime,t-this.thenForGame),this.maxDeltaTime),this.thenForGame=t},t.prototype.updateForBrowser=function(t){this.browserDeltaTime=Math.min(Math.max(0,t-this.thenForBrowser),this.maxDeltaTime),this.thenForBrowser=t},t.prototype.updateForPhysics=function(t){this.unscaledPhysicsDeltaTime=Math.min(Math.max(0,t-this.thenForPhysics),this.maxDeltaTime),this.thenForPhysics=t},t}(),z=function(){function t(t){var e=this;this._touching=!1,this._positionInViewport=new s(0,0),this._radius=new s(0,0),this.eventHandler=function(t){"touchstart"===t.type&&(e._touching=!0,e.updatePosition(t)),"touchmove"===t.type&&e.updatePosition(t),"touchend"!==t.type&&"touchcancel"!==t.type||(e._touching=!1)},this.canvas=t,this.canvas.addEventListener("touchstart",this.eventHandler),this.canvas.addEventListener("touchend",this.eventHandler),this.canvas.addEventListener("touchcancel",this.eventHandler),this.canvas.addEventListener("touchmove",this.eventHandler)}return Object.defineProperty(t.prototype,"positionInViewport",{get:function(){return this._positionInViewport},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"touching",{get:function(){return this._touching},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"radius",{get:function(){return this._radius},enumerable:!1,configurable:!0}),t.prototype.updatePosition=function(t){t.preventDefault(),t.stopPropagation(),0!==t.targetTouches.length&&(this._positionInViewport.set((t.targetTouches[0].clientX-this.canvas.offsetLeft)/(this.canvas.clientWidth/this.canvas.width)-this.canvas.width/2,-(t.targetTouches[0].clientY-this.canvas.offsetTop)/(this.canvas.clientHeight/this.canvas.height)+this.canvas.height/2),this._radius.set(t.targetTouches[0].radiusX,t.targetTouches[0].radiusY))},t}(),N=function(){function t(t,e,i,s){this.timeManager=t,this.physicsManager=e,this.gameObjectManager=i,this.sceneManager=s,this.running=!1,this.gameObjects=[],this.components=[]}return t.prototype.start=function(){this.startLoop(!0)},t.prototype.pause=function(){this.running=!1},t.prototype.resume=function(){this.startLoop(!1)},t.prototype.stop=function(){this.running=!1,this.sceneManager.unloadCurrentScene(),this.physicsManager.clear()},t.prototype.startLoop=function(t){this.running||(this.running=!0,t&&this.sceneManager.loadOpeningScene(),this.asyncGameLoop(),this.timeManager.gameFramerate!==this.timeManager.physicsFramerate&&this.asyncPhysicsLoop())},t.prototype.gameLogicIteration=function(t){this.timeManager.updateForGame(t),this.load(),this.dispatchFrameEvent(g.Start),this.dispatchFrameEvent(g.Update),this.dispatchFrameEvent(g.UpdateEngine),this.dispatchFrameEvent(g.UpdateTransform),this.timeManager.gameFramerate===this.timeManager.physicsFramerate&&(this.timeManager.updateForPhysics(t),this.physicsIteration()),this.sceneManager.update()},t.prototype.physicsIteration=function(){this.timeManager.timeScale<=0||(this.dispatchFrameEvent(g.UpdatePhysics),this.dispatchFrameEvent(g.UpdateCollider),this.dispatchFrameEvent(g.UpdateTransform),this.physicsManager.resolve(this.timeManager.physicsDeltaTime))},t.prototype.asyncGameLoop=function(){var t=this;this.gameInterval=setInterval((function(){if(!t.running)return clearInterval(t.gameInterval);t.gameLogicIteration(process.uptime())}),1e3/this.timeManager.gameFramerate)},t.prototype.asyncPhysicsLoop=function(){var t=this;this.physicsInterval=setInterval((function(){if(!t.running)return clearInterval(t.physicsInterval);t.timeManager.updateForPhysics(process.uptime()),t.physicsIteration()}),1e3/this.timeManager.physicsFramerate)},t.prototype.load=function(){this.currentScene=this.sceneManager.getCurrentScene(),this.gameObjects=this.gameObjectManager.findGameObjects().filter((function(t){return t.active})),this.components=this.gameObjects.reduce((function(t,e){return f(f([],t,!0),e.getComponents().filter((function(t){return t.active})),!0)}),[])},t.prototype.dispatchFrameEvent=function(t){t!==g.Start&&t!==g.Update||(this.currentScene.dispatch(t),this.gameObjects.filter((function(t){return t.active})).forEach((function(e){return e.dispatch(t)}))),this.components.filter((function(t){return t.active})).forEach((function(e){return e.dispatch(t)}))},t}();!function(t){t[t.Polygon=0]="Polygon",t[t.Circumference=1]="Circumference",t[t.Line=2]="Line"}(O||(O={})),function(t){t[t.WorldSpace=0]="WorldSpace",t[t.ViewPort=1]="ViewPort"}(S||(S={})),function(t){t[t.Sprite=0]="Sprite",t[t.Text=1]="Text",t[t.Tilemap=2]="Tilemap",t[t.Mask=3]="Mask",t[t.Geometric=4]="Geometric",t[t.Video=5]="Video"}(A||(A={}));class X{constructor(t){this.gl=t,this.viewport={x:0,x1:0,y:0,y1:0},this.object={x:0,x1:0,y:0,y1:0}}setViewport({position:t,zoom:e},i){i===S.WorldSpace?(this.viewport.x=t.x-this.gl.canvas.width/e/2,this.viewport.x1=t.x+this.gl.canvas.width/e/2,this.viewport.y=t.y-this.gl.canvas.height/e/2,this.viewport.y1=t.y+this.gl.canvas.height/e/2):(this.viewport.x=-this.gl.canvas.width/2,this.viewport.x1=this.gl.canvas.width/2,this.viewport.y=-this.gl.canvas.height/2,this.viewport.y1=this.gl.canvas.height/2)}setObjectForResizeable({position:t,width:e,height:i,rotation:s=0}){const o=Math.abs(Math.sin(s)),r=Math.abs(Math.cos(s)),n=o*i+r*e,a=o*e+r*i;this.object.x=t.x-n/2,this.object.x1=t.x+n/2,this.object.y=t.y-a/2,this.object.y1=t.y+a/2}setObjectForText({position:t,text:e,fontSize:i,lineSeparation:s,letterSpacing:o,rotation:r}){const n=e.split("\n").reduce(((t,e)=>Math.max(t,e.length)),0)*(i+(null!=o?o:0))*2,a=e.split("\n").length*(i+(null!=s?s:0));this.setObjectForResizeable({position:t,width:n,height:a,rotation:r})}setObjectForGeometric({position:t,vertexModel:e,shape:i,radius:s}){i===O.Circumference?(this.object.x=t.x-s,this.object.y=t.y-s,this.object.x1=t.x+s,this.object.y1=t.y+s):(this.object.x=Number.MAX_SAFE_INTEGER,this.object.y=Number.MAX_SAFE_INTEGER,this.object.x1=Number.MIN_SAFE_INTEGER,this.object.y1=Number.MIN_SAFE_INTEGER,e.forEach((e=>{this.object.x=Math.min(e.x+t.x,this.object.x),this.object.y=Math.min(e.y+t.y,this.object.y),this.object.x1=Math.max(e.x+t.x,this.object.x1),this.object.y1=Math.max(e.y+t.y,this.object.y1)})))}setObjectForTilemap(t){t.tilemap.height=Math.ceil(t.tiles.length/t.tilemap.width),this.setObjectForResizeable({position:t.renderPosition,width:t.tilemap.width*t.tilemap.tileWidth,height:t.tilemap.height*t.tilemap.tileHeight,rotation:t.rotation})}applyCullingInTiles(t){const{tiles:e,tilemap:{width:i,tileWidth:s,tileHeight:o}}=t;t.culledTiles=e.map(((t,e)=>this.viewport.x1>=this.object.x+e%i*s&&this.viewport.x<=this.object.x+e%i*s+s&&this.viewport.y1>=this.object.y1-((e/i|0)*o+o)&&this.viewport.y<=this.object.y1-(e/i|0)*o?t:0))}isInViewPort(t,e){switch(this.setViewport(e,t.location),t.type){case A.Video:case A.Mask:case A.Sprite:this.setObjectForResizeable(t);break;case A.Geometric:this.setObjectForGeometric(t);break;case A.Text:this.setObjectForText(t);break;case A.Tilemap:this.setObjectForTilemap(t)}return this.viewport.x1>=this.object.x&&this.viewport.x<=this.object.x1&&this.viewport.y1>=this.object.y&&this.viewport.y<=this.object.y1}applyCulling(t,e){return e.filter((e=>!!this.isInViewPort(e,t)&&(e.type===A.Tilemap&&this.applyCullingInTiles(e),!0)))}}class q{constructor(t=0,e=0){this._x=t,this._y=e}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}get magnitude(){return Math.sqrt(Math.pow(this._x,2)+Math.pow(this._y,2))}set(t,e){this._x=t,this._y=e}copy(t){this.set(t.x,t.y)}equals(t){return this._x===t.x&&this._y===t.y}clone(){return new q(this._x,this._y)}distance(t){return Math.sqrt(Math.pow(this._x-t.x,2)+Math.pow(this._y-t.y,2))}static add(t,e,i){return t.set(e.x+i.x,e.y+i.y),t}static subtract(t,e,i){return t.set(e.x-i.x,e.y-i.y),t}static unit(t,e){return 0===e.magnitude?t.set(0,0):t.set(e.x/e.magnitude,e.y/e.magnitude),t}static normal(t,e){return t.set(-e.y,e.x),this.unit(t,t)}static scale(t,e,i){return t.set(e.x*i,e.y*i),t}static dot(t,e){return t.x*e.x+t.y*e.y}static cross(t,e){return t.x*e.y-t.y*e.x}static round(t,e){return t.set(Math.round(e.x),Math.round(e.y)),t}}!function(t){t[t.Center=0]="Center",t[t.RightUp=1]="RightUp",t[t.RightDown=2]="RightDown",t[t.RightCenter=3]="RightCenter"}(T||(T={}));class K{constructor(t,e){this.webglManager=t,this.cullingManager=e,this.renderData=[],this.cameraData=[]}addRenderData(t){this.renderData.push(t)}addCameraData(t){this.cameraData.push(t)}render(){this.cameraData.sort(((t,e)=>t.depth-e.depth)).forEach((t=>this.renderByCamera(t)))}renderByCamera(t){this.cullingManager.applyCulling(t,this.renderData.filter((e=>t.layers.includes(e.layer))).sort(((e,i)=>t.layers.indexOf(e.layer)-t.layers.indexOf(i.layer))).map((t=>t.type===A.Tilemap?(t=>{const e=Object.assign(Object.assign({},t),{culledTiles:[],tilemap:Object.assign(Object.assign({},t.tilemap),{height:Math.ceil(t.tiles.length/t.tilemap.width),realWidth:t.tilemap.width*t.tilemap.tileWidth,realHeight:0}),renderPosition:new q});return e.tilemap.realHeight=e.tilemap.height*e.tilemap.tileHeight,(t=>{t.renderPosition.set(t.position.x+(t.orientation!==T.Center?t.tilemap.realWidth/2:0),t.position.y+(t.orientation===T.RightDown?-t.tilemap.realHeight/2:t.orientation===T.RightUp?t.tilemap.realHeight/2:0))})(e),e})(t):t))).forEach((e=>this.webglManager.render(e,t)))}clearData(){this.renderData=[],this.cameraData=[]}clearScreen(t){this.webglManager.clearCanvas(t)}preloadTexture(t){this.webglManager.createTexture(t)}}!function(t){t.LegacyWebGL="webgl",t.WebGL2="webgl2"}(E||(E={}));class ${constructor(t){if(this.canvas=t,this.contextVersion=this.getContextVersion(),!this.contextVersion)throw new Error("Your browser does not support WebGL.");this.gl=this.canvas.getContext(this.contextVersion)}getContextVersion(){return null!==this.canvas.getContext(E.WebGL2)?E.WebGL2:null!==this.canvas.getContext(E.LegacyWebGL)?E.LegacyWebGL:void 0}}class Q{constructor(){this.fontAtlas=new Map}hasFontAtlas(t){return this.fontAtlas.has(this.symbol(t))}getFontAtlas(t){return this.fontAtlas.get(this.symbol(t))}getOrCreate(t,e,i){var s;return null!==(s=this.getFontAtlas(e))&&void 0!==s?s:this.create(t,e,i)}create(t,e,i){this.bitmapSize=i,this.chars=[];for(let e=0;e<t.length;e+=2)for(let i=t[e];i<=t[e+1];i++)this.chars.push(String.fromCharCode(i));const s=this.renderAtlas(e instanceof FontFace?e.family:e);return this.fontAtlas.set(this.symbol(e),s),s}symbol(t){return Symbol.for(t instanceof FontFace?t.family:t)}renderAtlas(t){const e=new J(t,this.bitmapSize,Math.ceil(Math.sqrt(this.chars.length))),i=e.canvas.getContext("2d");i.clearRect(0,0,e.canvas.width,e.canvas.height),i.textBaseline="top",i.fillStyle="#000",i.font=`${this.bitmapSize}px ${t}`;let s=0,o=0;for(let t=0;t<this.chars.length;t++)i.fillText(this.chars[t],s,o),e.glyphs.set(this.chars[t],{id:t,width:i.measureText(this.chars[t]).width}),(s+=this.bitmapSize)>e.canvas.width-this.bitmapSize&&(s=0,o+=this.bitmapSize);return e}}class J{constructor(t,e,i){this.fontFaceFamily=t,this.bitmapFontSize=e,this.gridSize=i,this.canvas=document.createElement("canvas"),this.glyphs=new Map,this.canvas.width=this.gridSize*this.bitmapFontSize,this.canvas.height=this.canvas.width}}class Z{constructor(t,e){this.gl=t,this.shaderLoader=e}create(t,e){const i=this.gl.createProgram(),s=this.shaderLoader.load(this.gl.VERTEX_SHADER,t),o=this.shaderLoader.load(this.gl.FRAGMENT_SHADER,e);this.gl.attachShader(i,s),this.gl.attachShader(i,o),this.gl.linkProgram(i);const r=this.gl.LINK_STATUS;if(!this.gl.getProgramParameter(i,r)){const t=this.gl.getProgramInfoLog(i);throw this.gl.deleteProgram(i),new Error(`Unable to initialize the Program: ${t}`)}return i}}class tt{constructor(t,e,i){this.gl=t,this.contextVersion=e,this.programFactory=i}loadProgram(){this.program=this.contextVersion===E.WebGL2?this.programFactory.create("#version 300 es\nprecision mediump float;\n\nin vec2 positionCoords;\nin vec2 textureCoords;\n\nout vec2 texCoords;\n\nuniform mat4 projectionMatrix;\nuniform mat4 modelMatrix;\nuniform mat4 textureMatrix;\n\nvoid main()\n{\n    gl_Position = projectionMatrix * modelMatrix * vec4(positionCoords, 0, 1);\n    texCoords = (textureMatrix * vec4(textureCoords, 0, 1)).xy;\n}","#version 300 es\nprecision mediump float;\n\nout vec4 fragColor;\n\nin vec2 texCoords;\n\nuniform int u_renderTexture;\nuniform sampler2D u_texImage;\nuniform vec4 u_solidColor;\n\nuniform int u_useTintColor;\nuniform vec4 u_tintColor;\n\nuniform int u_useMaskColor;\nuniform vec4 u_maskColor;\nuniform float u_maskColorMix;\n\nuniform float u_alpha;\n\nvoid main()\n{\n    if (u_renderTexture == 1) {\n        vec4 texColor = texture(u_texImage, texCoords);\n\n        if (texColor.a < 0.0001) {\n            discard;\n        }\n\n        if (u_useTintColor == 1) {\n            texColor = u_tintColor * texColor;\n        }\n\n        if (u_useMaskColor == 1) {\n            texColor = mix(texColor, u_maskColor, clamp(u_maskColorMix, 0.0, 1.0));\n        }\n\n        fragColor = vec4(texColor.rgb, u_alpha * texColor.a);        \n    } else {\n        fragColor = vec4(u_solidColor.rgb, u_alpha);\n    }\n}"):this.programFactory.create("precision mediump float;\n\nattribute vec2 positionCoords;\nattribute vec2 textureCoords;\n\nvarying vec2 texCoords;\n\nuniform mat4 projectionMatrix;\nuniform mat4 modelMatrix;\nuniform mat4 textureMatrix;\n\nvoid main()\n{\n    gl_Position = projectionMatrix * modelMatrix * vec4(positionCoords, 0, 1);\n    texCoords = (textureMatrix * vec4(textureCoords, 0, 1)).xy;\n}","precision mediump float;\n\nvarying vec2 texCoords;\n\nuniform int u_renderTexture;\nuniform sampler2D u_texImage;\nuniform vec4 u_solidColor;\n\nuniform int u_useTintColor;\nuniform vec4 u_tintColor;\n\nuniform int u_useMaskColor;\nuniform vec4 u_maskColor;\nuniform float u_maskColorMix;\n\nuniform float u_alpha;\n\nvoid main()\n{\n    if (u_renderTexture == 1) {\n        vec4 texColor = texture2D(u_texImage, texCoords);\n\n        if (texColor.a < 0.0001) {\n            discard;\n        }\n\n        if (u_useTintColor == 1) {\n            texColor = u_tintColor * texColor;\n        }\n\n        if (u_useMaskColor == 1) {\n            texColor = mix(texColor, u_maskColor, clamp(u_maskColorMix, 0.0, 1.0));\n        }\n\n        gl_FragColor = vec4(texColor.rgb, u_alpha * texColor.a);\n    } else {\n        gl_FragColor =  vec4(u_solidColor.rgb, u_alpha);\n    }\n}"),this.positionBuffer=this.gl.createBuffer(),this.textureBuffer=this.gl.createBuffer(),this.positionCoordsAttr=this.gl.getAttribLocation(this.program,"positionCoords"),this.texCoordsAttr=this.gl.getAttribLocation(this.program,"textureCoords"),this.modelMatrixUniform=this.gl.getUniformLocation(this.program,"modelMatrix"),this.projectionMatrixUniform=this.gl.getUniformLocation(this.program,"projectionMatrix"),this.textureMatrixUniform=this.gl.getUniformLocation(this.program,"textureMatrix"),this.renderTextureUniform=this.gl.getUniformLocation(this.program,"u_renderTexture"),this.textureUniform=this.gl.getUniformLocation(this.program,"u_texImage"),this.solidColorUniform=this.gl.getUniformLocation(this.program,"u_solidColor"),this.useTintColorUniform=this.gl.getUniformLocation(this.program,"u_useTintColor"),this.tintColorUniform=this.gl.getUniformLocation(this.program,"u_tintColor"),this.useMaskColorUniform=this.gl.getUniformLocation(this.program,"u_useMaskColor"),this.maskColorUniform=this.gl.getUniformLocation(this.program,"u_maskColor"),this.maskColorMixUniform=this.gl.getUniformLocation(this.program,"u_maskColorMix"),this.alphaUniform=this.gl.getUniformLocation(this.program,"u_alpha"),this.gl.useProgram(this.program),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.enableVertexAttribArray(this.positionCoordsAttr),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionBuffer),this.gl.vertexAttribPointer(this.positionCoordsAttr,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.texCoordsAttr),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.textureBuffer),this.gl.vertexAttribPointer(this.texCoordsAttr,2,this.gl.FLOAT,!1,0,0)}}class et{constructor(t){this.gl=t}load(t,e){const i=this.gl.createShader(t);this.gl.shaderSource(i,e),this.gl.compileShader(i);const s=this.gl.COMPILE_STATUS;if(!this.gl.getShaderParameter(i,s)){const t=this.gl.getShaderInfoLog(i);throw this.gl.deleteShader(i),new Error(`Unable to initialize the shader program: ${t}`)}return i}}var it,st="undefined"!=typeof Float32Array?Float32Array:Array;function ot(){var t=new st(16);return st!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function rt(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function nt(t,e,i){var s,o,r,n,a,h,l,c,d,u,p,g,m=i[0],f=i[1],y=i[2];return e===t?(t[12]=e[0]*m+e[4]*f+e[8]*y+e[12],t[13]=e[1]*m+e[5]*f+e[9]*y+e[13],t[14]=e[2]*m+e[6]*f+e[10]*y+e[14],t[15]=e[3]*m+e[7]*f+e[11]*y+e[15]):(s=e[0],o=e[1],r=e[2],n=e[3],a=e[4],h=e[5],l=e[6],c=e[7],d=e[8],u=e[9],p=e[10],g=e[11],t[0]=s,t[1]=o,t[2]=r,t[3]=n,t[4]=a,t[5]=h,t[6]=l,t[7]=c,t[8]=d,t[9]=u,t[10]=p,t[11]=g,t[12]=s*m+a*f+d*y+e[12],t[13]=o*m+h*f+u*y+e[13],t[14]=r*m+l*f+p*y+e[14],t[15]=n*m+c*f+g*y+e[15]),t}function at(t,e,i){var s=i[0],o=i[1],r=i[2];return t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t[3]=e[3]*s,t[4]=e[4]*o,t[5]=e[5]*o,t[6]=e[6]*o,t[7]=e[7]*o,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function ht(t,e,i){var s=Math.sin(i),o=Math.cos(i),r=e[0],n=e[1],a=e[2],h=e[3],l=e[4],c=e[5],d=e[6],u=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=r*o+l*s,t[1]=n*o+c*s,t[2]=a*o+d*s,t[3]=h*o+u*s,t[4]=l*o-r*s,t[5]=c*o-n*s,t[6]=d*o-a*s,t[7]=u*o-h*s,t}function lt(){var t=new st(3);return st!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function ct(t,e,i){var s=new st(3);return s[0]=t,s[1]=e,s[2]=i,s}function dt(){var t=new st(4);return st!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)}),lt(),function(){var t;t=new st(4),st!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0)}(),lt(),ct(1,0,0),ct(0,1,0),dt(),dt(),it=new st(9),st!=Float32Array&&(it[1]=0,it[2]=0,it[3]=0,it[5]=0,it[6]=0,it[7]=0),it[0]=1,it[4]=1,it[8]=1,function(){var t=new st(2);st!=Float32Array&&(t[0]=0,t[1]=0)}();const ut=t=>{const e=/^#?([a-f\d]{2})?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[2],16)/256,g:parseInt(e[3],16)/256,b:parseInt(e[4],16)/256,a:void 0!==e[1]?parseInt(e[1],16)/256:1}:null},pt=(t,e,i,s)=>{var o,r;(function(t,e,i,s,o,r,n){var a=1/(e-i),h=1/(s-o);t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*h,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=-1,t[11]=0,t[12]=(e+i)*a,t[13]=(o+s)*h,t[14]=-0,t[15]=1})(t=rt(t),-e.canvas.width/2,e.canvas.width/2,-e.canvas.height/2,e.canvas.height/2),nt(t,t,[0,0,0]),s===S.WorldSpace&&at(t,t,[null!==(o=i.zoom)&&void 0!==o?o:1,null!==(r=i.zoom)&&void 0!==r?r:1,1])};class gt{constructor(t,e){this.gl=t,this.programManager=e,this.vertices=new Map,this.lastVertices=null,this.modelPosition=new q,this.projectionMatrix=ot(),this.modelMatrix=ot(),this.textureMatrix=ot();const i=2*Math.PI/60;this.circumferenceVertices=new Float32Array(((t,e,i=1)=>{const s=[];for(let t=1;t<=e;t+=i)s.push(t);return s})(0,60,1).reduce(((t,e)=>[...t,Math.cos(e*i),Math.sin(e*i)]),[]))}render(t,e,i){switch(t.shape){case O.Polygon:this.renderLines(t,e,this.gl.LINE_LOOP,i);break;case O.Line:this.renderLines(t,e,this.gl.LINES,i);break;case O.Circumference:this.renderCircumference(t,e)}}renderLines(t,e,i,s){var o;const r=this.generateVerticesKey(t.vertexModel);!1===this.vertices.has(r)&&this.vertices.set(r,new Float32Array(this.generatePolygonVertices(t.vertexModel)));const n=this.vertices.get(r);this.lastVertices===r&&s===A.Geometric||(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.programManager.positionBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,n,this.gl.DYNAMIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.programManager.textureBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,n,this.gl.DYNAMIC_DRAW)),this.lastVertices=r,this.modelMatrix=rt(this.modelMatrix),q.round(this.modelPosition,t.location===S.WorldSpace?q.subtract(this.modelPosition,t.position,e.position):t.position),nt(this.modelMatrix,this.modelMatrix,[this.modelPosition.x,this.modelPosition.y,0]),ht(this.modelMatrix,this.modelMatrix,null!==(o=t.rotation)&&void 0!==o?o:0),pt(this.projectionMatrix,this.gl,e,t.location),this.gl.uniformMatrix4fv(this.programManager.projectionMatrixUniform,!1,this.projectionMatrix),this.gl.uniformMatrix4fv(this.programManager.modelMatrixUniform,!1,this.modelMatrix),this.gl.uniformMatrix4fv(this.programManager.textureMatrixUniform,!1,this.textureMatrix),this.gl.uniform1i(this.programManager.renderTextureUniform,0);const{r:a,g:h,b:l,a:c}=ut(t.color);this.gl.uniform4f(this.programManager.solidColorUniform,a,h,l,c),this.gl.uniform1f(this.programManager.alphaUniform,1),this.gl.drawArrays(i,0,n.length/2)}generateVerticesKey(t){return Symbol.for(t.reduce(((t,e)=>`${t}${e.x}${e.y}`),t.length.toString()))}generatePolygonVertices(t){const e=[];for(let i=0;i<t.length;i++)e.push(t[i].x,t[i].y);return e}renderCircumference(t,e){this.lastVertices=null,this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.programManager.positionBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.circumferenceVertices,this.gl.DYNAMIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.programManager.textureBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.circumferenceVertices,this.gl.DYNAMIC_DRAW),this.modelMatrix=rt(this.modelMatrix),q.round(this.modelPosition,t.location===S.WorldSpace?q.subtract(this.modelPosition,t.position,e.position):t.position),nt(this.modelMatrix,this.modelMatrix,[this.modelPosition.x,this.modelPosition.y,0]),at(this.modelMatrix,this.modelMatrix,[t.radius,t.radius,1]),pt(this.projectionMatrix,this.gl,e,t.location),this.gl.uniformMatrix4fv(this.programManager.projectionMatrixUniform,!1,this.projectionMatrix),this.gl.uniformMatrix4fv(this.programManager.modelMatrixUniform,!1,this.modelMatrix),this.gl.uniformMatrix4fv(this.programManager.textureMatrixUniform,!1,this.textureMatrix),this.gl.uniform1i(this.programManager.renderTextureUniform,0);const{r:i,g:s,b:o,a:r}=ut(t.color);this.gl.uniform4f(this.programManager.solidColorUniform,i,s,o,r),this.gl.uniform1f(this.programManager.alphaUniform,1),this.gl.drawArrays(this.gl.LINE_LOOP,0,this.circumferenceVertices.length/2)}}class mt{constructor(t,e){this.gl=t,this.programManager=e,this.type=A.Mask,this.vertices=new Float32Array([-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,.5,.5]),this.modelPosition=new q,this.projectionMatrix=ot(),this.modelMatrix=ot(),this.textureMatrix=ot()}render(t,e,i){var s,o;i!==A.Mask&&(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.programManager.positionBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.vertices,this.gl.STATIC_DRAW)),this.modelMatrix=rt(this.modelMatrix),q.round(this.modelPosition,t.location===S.WorldSpace?q.subtract(this.modelPosition,t.position,e.position):t.position),nt(this.modelMatrix,this.modelMatrix,[this.modelPosition.x,this.modelPosition.y,0]),ht(this.modelMatrix,this.modelMatrix,null!==(s=t.rotation)&&void 0!==s?s:0),at(this.modelMatrix,this.modelMatrix,[t.width,t.height,1]),pt(this.projectionMatrix,this.gl,e,t.location),this.gl.uniformMatrix4fv(this.programManager.projectionMatrixUniform,!1,this.projectionMatrix),this.gl.uniformMatrix4fv(this.programManager.modelMatrixUniform,!1,this.modelMatrix),this.gl.uniformMatrix4fv(this.programManager.textureMatrixUniform,!1,this.textureMatrix),t.alpha>=0&&t.alpha<1?this.gl.enable(this.gl.BLEND):this.gl.disable(this.gl.BLEND),this.gl.uniform1i(this.programManager.renderTextureUniform,0);const{r,g:n,b:a,a:h}=ut(t.color);this.gl.uniform4f(this.programManager.solidColorUniform,r,n,a,h),this.gl.uniform1f(this.programManager.alphaUniform,null!==(o=t.alpha)&&void 0!==o?o:1),this.gl.drawArrays(this.gl.TRIANGLES,0,6)}}class ft{constructor(t,e,i){this.gl=t,this.programManager=e,this.textureManager=i,this.lastTexture=null,this.modelPosition=new q,this.projectionMatrix=ot(),this.modelMatrix=ot(),this.textureMatrix=ot(),this.posVertices=new Float32Array([-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,.5,.5]),this.texVertices=new Float32Array([0,1,0,0,1,1,1,1,0,0,1,0])}render(t,e,i){var s,o,r,n;i!==t.type&&(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.programManager.positionBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.posVertices,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.programManager.textureBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.texVertices,this.gl.STATIC_DRAW)),this.modelMatrix=rt(this.modelMatrix),q.round(this.modelPosition,t.location===S.WorldSpace?q.subtract(this.modelPosition,t.position,e.position):t.position),nt(this.modelMatrix,this.modelMatrix,[this.modelPosition.x,this.modelPosition.y,0]),ht(this.modelMatrix,this.modelMatrix,null!==(s=t.rotation)&&void 0!==s?s:0),at(this.modelMatrix,this.modelMatrix,[t.width*(t.flipHorizontal?-1:1),t.height*(t.flipVertical?-1:1),1]),this.textureMatrix=rt(this.textureMatrix),t.slice&&(nt(this.textureMatrix,this.textureMatrix,[t.slice.x/t.image.naturalWidth,t.slice.y/t.image.naturalHeight,0]),at(this.textureMatrix,this.textureMatrix,[t.slice.width/t.image.naturalWidth,t.slice.height/t.image.naturalHeight,1])),pt(this.projectionMatrix,this.gl,e,t.location),this.gl.uniformMatrix4fv(this.programManager.projectionMatrixUniform,!1,this.projectionMatrix),this.gl.uniformMatrix4fv(this.programManager.modelMatrixUniform,!1,this.modelMatrix),this.gl.uniformMatrix4fv(this.programManager.textureMatrixUniform,!1,this.textureMatrix),this.gl.enable(this.gl.BLEND);const a=this.textureManager.getOrCreateTextureFromImage(t.image,t.smooth);if(this.lastTexture===a&&i===t.type||(this.gl.bindTexture(this.gl.TEXTURE_2D,a),this.gl.uniform1i(this.programManager.textureUniform,0),this.lastTexture=a),this.gl.uniform1i(this.programManager.renderTextureUniform,1),this.gl.uniform1f(this.programManager.alphaUniform,null!==(o=t.alpha)&&void 0!==o?o:1),this.gl.uniform1i(this.programManager.useTintColorUniform,t.tintColor?1:0),t.tintColor){const{r:e,g:i,b:s,a:o}=ut(t.tintColor);this.gl.uniform4f(this.programManager.tintColorUniform,e,i,s,o)}if(this.gl.uniform1i(this.programManager.useMaskColorUniform,t.maskColor?1:0),t.maskColor){const{r:e,g:i,b:s}=ut(t.maskColor);this.gl.uniform4f(this.programManager.maskColorUniform,e,i,s,null!==(r=t.alpha)&&void 0!==r?r:1),this.gl.uniform1f(this.programManager.maskColorMixUniform,null!==(n=t.maskColorMix)&&void 0!==n?n:1)}this.gl.drawArrays(this.gl.TRIANGLES,0,6)}}var yt;!function(t){t[t.Center=0]="Center",t[t.RightUp=1]="RightUp",t[t.RightDown=2]="RightDown",t[t.RightCenter=3]="RightCenter"}(yt||(yt={}));const vt=new q,xt=new q,bt=[32,126,161,255],Mt=yt.Center;class wt{constructor(t,e,i,s){this.gl=t,this.programManager=e,this.textureManager=i,this.fontAtlasFactory=s,this.type=A.Text,this.posVertices=[],this.texVertices=[],this.lastTexture=null,this.textSize=new q,this.modelPosition=new q,this.projectionMatrix=ot(),this.modelMatrix=ot(),this.textureMatrix=ot()}render(t,e,i){var s;if(!t.text)throw new Error("Nothing to render");this.setDefaultValues(t);const o=this.fontAtlasFactory.getOrCreate(t.bitmap.charRanges,t.font,t.bitmap.fontSize);this.generateTextVertices(o,t),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.programManager.positionBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this.posVertices),this.gl.DYNAMIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.programManager.textureBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this.texVertices),this.gl.DYNAMIC_DRAW),this.modelMatrix=rt(this.modelMatrix),this.setPositionFromOrientation(t),q.round(this.modelPosition,t.location===S.WorldSpace?q.subtract(this.modelPosition,this.modelPosition,e.position):this.modelPosition),nt(this.modelMatrix,this.modelMatrix,[this.modelPosition.x,this.modelPosition.y,0]),ht(this.modelMatrix,this.modelMatrix,null!==(s=t.rotation)&&void 0!==s?s:0),at(this.modelMatrix,this.modelMatrix,[t.fontSize,t.fontSize,1]),this.textureMatrix=rt(this.textureMatrix),pt(this.projectionMatrix,this.gl,e,t.location),this.gl.uniformMatrix4fv(this.programManager.projectionMatrixUniform,!1,this.projectionMatrix),this.gl.uniformMatrix4fv(this.programManager.modelMatrixUniform,!1,this.modelMatrix),this.gl.uniformMatrix4fv(this.programManager.textureMatrixUniform,!1,this.textureMatrix),t.alpha<1?this.gl.enable(this.gl.BLEND):this.gl.disable(this.gl.BLEND);const r=this.textureManager.getOrCreateTextureFromCanvas("FontFamily:"+o.fontFaceFamily,o.canvas,t.smooth);this.lastTexture===r&&i===A.Text||(this.gl.bindTexture(this.gl.TEXTURE_2D,r),this.gl.uniform1i(this.programManager.textureUniform,0),this.lastTexture=r),this.gl.uniform1i(this.programManager.useTintColorUniform,0),this.gl.uniform1i(this.programManager.renderTextureUniform,1),this.gl.uniform1f(this.programManager.alphaUniform,t.alpha);const{r:n,g:a,b:h,a:l}=ut(t.color);this.gl.uniform4f(this.programManager.maskColorUniform,n,a,h,l),this.gl.uniform1f(this.programManager.maskColorMixUniform,1),this.gl.uniform1i(this.programManager.useMaskColorUniform,1),this.gl.drawArrays(this.gl.TRIANGLES,0,this.posVertices.length/2)}setDefaultValues(t){var e,i,s,o,r,n,a,h,l,c;t.bitmap?(t.bitmap.margin=null!==(e=t.bitmap.margin)&&void 0!==e?e:vt,t.bitmap.spacing=null!==(i=t.bitmap.spacing)&&void 0!==i?i:xt,t.bitmap.fontSize=null!==(s=t.bitmap.fontSize)&&void 0!==s?s:64,t.bitmap.charRanges=null!==(o=t.bitmap.charRanges)&&void 0!==o?o:bt):t.bitmap={margin:vt,spacing:xt,fontSize:64,charRanges:bt},t.color=null!==(r=t.color)&&void 0!==r?r:"#000000",t.letterSpacing=null!==(n=t.letterSpacing)&&void 0!==n?n:0,t.lineSeparation=null!==(a=t.lineSeparation)&&void 0!==a?a:0,t.alpha=null!==(h=t.alpha)&&void 0!==h?h:1,t.orientation=null!==(l=t.orientation)&&void 0!==l?l:Mt,t.rotation=null!==(c=t.rotation)&&void 0!==c?c:0}generateTextVertices(t,{text:e,fontSize:i,bitmap:s,letterSpacing:o,lineSeparation:r}){this.posVertices=[],this.texVertices=[];let n=0,a=0,h=0;o/=i,r/=i;for(let i=0;i<e.length;i++){const l=e[i];if("\n"===l){h=Math.max(h,n),n=0,a-=1+r;continue}const c=t.glyphs.get(l);if(c){const e=c.width/t.bitmapFontSize;this.posVertices.push(n,a-1,n+e,a-1,n,a,n,a,n+e,a-1,n+e,a);const i=c.id%t.gridSize*t.bitmapFontSize,r=(c.id/t.gridSize|0)*t.bitmapFontSize,h=(i+s.margin.x)/t.canvas.width,l=(r+s.margin.y)/t.canvas.width,d=(i+c.width+s.spacing.x)/t.canvas.width,u=(r+t.bitmapFontSize+s.spacing.y)/t.canvas.width;this.texVertices.push(h,u,d,u,h,l,h,l,d,u,d,l),n+=e+o}}this.textSize.set(Math.max(h,n)*i,Math.abs(a-1)*i)}setPositionFromOrientation(t){this.modelPosition.set(t.position.x+(t.orientation===yt.Center?-this.textSize.x/2:0),t.position.y+(t.orientation===yt.Center||t.orientation===yt.RightCenter?this.textSize.y/2:t.orientation===yt.RightUp?this.textSize.y:0))}}class Ct{constructor(t,e,i){this.gl=t,this.programManager=e,this.textureManager=i,this.posVertices=[],this.texVertices=[],this.lastTexture=null,this.tileset={width:0,tileWidth:0,tileHeight:0,texMargin:new q,texSpacing:new q,texWidth:0,texHeight:0,texCorrection:new q},this.modelPosition=new q,this.projectionMatrix=ot(),this.modelMatrix=ot(),this.textureMatrix=ot()}render(t,e,i){var s,o,r,n;if(0===t.culledTiles.reduce(((t,e)=>t+e),0))throw new Error("Nothing to render");if(this.processTileset(t),this.generateVertices(t),0===this.posVertices.length)throw new Error("Nothing to render");this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.programManager.positionBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this.posVertices),this.gl.DYNAMIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.programManager.textureBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this.texVertices),this.gl.DYNAMIC_DRAW),this.modelMatrix=rt(this.modelMatrix),q.round(this.modelPosition,t.location===S.WorldSpace?q.subtract(this.modelPosition,t.renderPosition,e.position):t.renderPosition),nt(this.modelMatrix,this.modelMatrix,[this.modelPosition.x,this.modelPosition.y,0]),ht(this.modelMatrix,this.modelMatrix,null!==(s=t.rotation)&&void 0!==s?s:0),at(this.modelMatrix,this.modelMatrix,[t.tilemap.tileWidth*(t.flipHorizontal?-1:1),t.tilemap.tileHeight*(t.flipVertical?-1:1),1]),this.textureMatrix=rt(this.textureMatrix),at(this.textureMatrix,this.textureMatrix,[this.tileset.tileWidth/t.tileset.image.naturalWidth,this.tileset.tileHeight/t.tileset.image.naturalHeight,1]),pt(this.projectionMatrix,this.gl,e,t.location),this.gl.uniformMatrix4fv(this.programManager.projectionMatrixUniform,!1,this.projectionMatrix),this.gl.uniformMatrix4fv(this.programManager.modelMatrixUniform,!1,this.modelMatrix),this.gl.uniformMatrix4fv(this.programManager.textureMatrixUniform,!1,this.textureMatrix),this.gl.enable(this.gl.BLEND);const a=this.textureManager.getOrCreateTextureFromImage(t.tileset.image,t.smooth);if(this.lastTexture===a&&i===A.Tilemap||(this.gl.bindTexture(this.gl.TEXTURE_2D,a),this.gl.uniform1i(this.programManager.textureUniform,0),this.lastTexture=a),this.gl.uniform1i(this.programManager.renderTextureUniform,1),this.gl.uniform1f(this.programManager.alphaUniform,null!==(o=t.alpha)&&void 0!==o?o:1),this.gl.uniform1i(this.programManager.useTintColorUniform,t.tintColor?1:0),t.tintColor){const{r:e,g:i,b:s,a:o}=ut(t.tintColor);this.gl.uniform4f(this.programManager.tintColorUniform,e,i,s,o)}if(this.gl.uniform1i(this.programManager.useMaskColorUniform,t.maskColor?1:0),t.maskColor){const{r:e,g:i,b:s}=ut(t.maskColor);this.gl.uniform4f(this.programManager.maskColorUniform,e,i,s,null!==(r=t.alpha)&&void 0!==r?r:1),this.gl.uniform1f(this.programManager.maskColorMixUniform,null!==(n=t.maskColorMix)&&void 0!==n?n:1)}this.gl.drawArrays(this.gl.TRIANGLES,0,this.posVertices.length/2)}processTileset({tileset:t}){var e,i,s,o,r,n,a;t.margin=null!==(e=t.margin)&&void 0!==e?e:new q,t.spacing=null!==(i=t.spacing)&&void 0!==i?i:new q,t.correction=null!==(s=t.correction)&&void 0!==s?s:new q,this.tileset.width=t.width,this.tileset.tileWidth=t.tileWidth+(null!==(o=t.margin.x)&&void 0!==o?o:0)+(null!==(r=t.spacing.x)&&void 0!==r?r:0),this.tileset.tileHeight=t.tileHeight+(null!==(n=t.margin.y)&&void 0!==n?n:0)+(null!==(a=t.spacing.y)&&void 0!==a?a:0),this.tileset.texMargin.set(t.margin.x/this.tileset.tileWidth,t.margin.y/this.tileset.tileHeight),this.tileset.texSpacing.set(t.spacing.x/this.tileset.tileWidth,t.spacing.y/this.tileset.tileHeight),this.tileset.texCorrection.set(t.correction.x/this.tileset.tileWidth,t.correction.y/this.tileset.tileHeight),this.tileset.texWidth=1-this.tileset.texMargin.x-this.tileset.texSpacing.x-2*this.tileset.texCorrection.x,this.tileset.texHeight=1-this.tileset.texMargin.y-this.tileset.texSpacing.y-2*this.tileset.texCorrection.y}generateVertices({culledTiles:t,tilemap:e}){this.posVertices=[],this.texVertices=[];const i=Math.floor(t.length/e.width);t.forEach(((t,s)=>{if(0===t)return;const o=s%e.width-e.width/2,r=i/2-Math.floor(s/e.width);this.posVertices.push(o,r-1,o+1,r-1,o,r,o,r,o+1,r-1,o+1,r);const n=(t-1)%this.tileset.width+this.tileset.texMargin.x+this.tileset.texCorrection.x,a=Math.floor((t-1)/this.tileset.width)+this.tileset.texMargin.y+this.tileset.texCorrection.y;this.texVertices.push(n,a+this.tileset.texHeight,n+this.tileset.texWidth,a+this.tileset.texHeight,n,a,n,a,n+this.tileset.texWidth,a+this.tileset.texHeight,n+this.tileset.texWidth,a)}))}}class _t{constructor(t,e,i){this.gl=t,this.programManager=e,this.textureManager=i,this.lastTexture=null,this.modelPosition=new q,this.projectionMatrix=ot(),this.modelMatrix=ot(),this.textureMatrix=ot(),this.posVertices=new Float32Array([-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,.5,.5]),this.texVertices=new Float32Array([0,1,0,0,1,1,1,1,0,0,1,0])}render(t,e,i){var s,o,r,n;i!==t.type&&(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.programManager.positionBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.posVertices,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.programManager.textureBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.texVertices,this.gl.STATIC_DRAW)),this.modelMatrix=rt(this.modelMatrix),q.round(this.modelPosition,t.location===S.WorldSpace?q.subtract(this.modelPosition,t.position,e.position):t.position),nt(this.modelMatrix,this.modelMatrix,[this.modelPosition.x,this.modelPosition.y,0]),ht(this.modelMatrix,this.modelMatrix,null!==(s=t.rotation)&&void 0!==s?s:0),at(this.modelMatrix,this.modelMatrix,[t.width*(t.flipHorizontal?-1:1),t.height*(t.flipVertical?-1:1),1]),this.textureMatrix=rt(this.textureMatrix),t.slice&&(nt(this.textureMatrix,this.textureMatrix,[t.slice.x/t.video.videoWidth,t.slice.y/t.video.videoHeight,0]),at(this.textureMatrix,this.textureMatrix,[t.slice.width/t.video.videoWidth,t.slice.height/t.video.videoHeight,1])),pt(this.projectionMatrix,this.gl,e,t.location),this.gl.uniformMatrix4fv(this.programManager.projectionMatrixUniform,!1,this.projectionMatrix),this.gl.uniformMatrix4fv(this.programManager.modelMatrixUniform,!1,this.modelMatrix),this.gl.uniformMatrix4fv(this.programManager.textureMatrixUniform,!1,this.textureMatrix),this.gl.enable(this.gl.BLEND);const a=this.textureManager.getOrCreateTextureFromVideo(t.video);if(this.lastTexture===a&&i===t.type||(this.gl.bindTexture(this.gl.TEXTURE_2D,a),this.gl.uniform1i(this.programManager.textureUniform,0),this.lastTexture=a),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t.video),this.gl.uniform1i(this.programManager.renderTextureUniform,1),this.gl.uniform1f(this.programManager.alphaUniform,null!==(o=t.alpha)&&void 0!==o?o:1),this.gl.uniform1i(this.programManager.useTintColorUniform,t.tintColor?1:0),t.tintColor){const{r:e,g:i,b:s,a:o}=ut(t.tintColor);this.gl.uniform4f(this.programManager.tintColorUniform,e,i,s,o)}if(this.gl.uniform1i(this.programManager.useMaskColorUniform,t.maskColor?1:0),t.maskColor){const{r:e,g:i,b:s}=ut(t.maskColor);this.gl.uniform4f(this.programManager.maskColorUniform,e,i,s,null!==(r=t.alpha)&&void 0!==r?r:1),this.gl.uniform1f(this.programManager.maskColorMixUniform,null!==(n=t.maskColorMix)&&void 0!==n?n:1)}this.gl.drawArrays(this.gl.TRIANGLES,0,6)}}class jt{constructor(t){this.gl=t}createFromImage(t,e=!0,i=null){return i=null!=i?i:this.gl.createTexture(),t.naturalWidth?this.createFromSource(t,i,e):t.addEventListener("load",(()=>this.createFromSource(t,i,e))),i}createFromCanvas(t,e=!0,i=null){return i=null!=i?i:this.gl.createTexture(),this.createFromSource(t,i,e),i}createPixelTexture(){const t=this.gl.createTexture();return this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,1,1,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,new Uint8Array([0,0,0,255])),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.bindTexture(this.gl.TEXTURE_2D,null),t}createFromSource(t,e,i=!0){this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),!1===i?(this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST)):(this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR)),this.gl.bindTexture(this.gl.TEXTURE_2D,null)}}class Pt{constructor(t){this.textureFactory=t,this.textures=new Map}getOrCreateTextureFromImage(t,e=!0){var i;return null!==(i=this.textures.get(Symbol.for(t.src)))&&void 0!==i?i:this.createTextureFromImage(t,e)}createTextureFromImage(t,e=!0){const i=this.textureFactory.createFromImage(t,e);return this.textures.set(Symbol.for(t.src),i),i}getOrCreateTextureFromCanvas(t,e,i=!0){var s;return null!==(s=this.textures.get(Symbol.for(t)))&&void 0!==s?s:this.createTextureFromCanvas(t,e,i)}createTextureFromCanvas(t,e,i=!0){const s=this.textureFactory.createFromCanvas(e,i);return this.textures.set(Symbol.for(t),s),s}getOrCreateTextureFromVideo(t){var e;return null!==(e=this.textures.get(Symbol.for(t.src)))&&void 0!==e?e:this.createTextureFromVideo(t)}createTextureFromVideo(t){const e=this.textureFactory.createPixelTexture();return this.textures.set(Symbol.for(t.src),e),e}}class Rt{constructor(t,e,i,s){this.gl=t,this.textureManager=i,this.renderers=s,e.loadProgram()}render(t,e){try{this.renderers.get(t.type).render(t,e,this.lastRender),this.lastRender=t.type}catch(t){return}}clearCanvas(t){const e=ut(t);this.gl.clearColor(e.r,e.g,e.b,e.a),this.gl.clear(this.gl.COLOR_BUFFER_BIT)}createTexture(t,e=!1){this.textureManager.createTextureFromImage(t,e)}}class Ot{constructor(t=0,e=0){this._x=t,this._y=e}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}get magnitude(){return Math.sqrt(Math.pow(this._x,2)+Math.pow(this._y,2))}set(t,e){this._x=t,this._y=e}copy(t){this.set(t.x,t.y)}equals(t){return this._x===t.x&&this._y===t.y}clone(){return new Ot(this._x,this._y)}distance(t){return Math.sqrt(Math.pow(this._x-t.x,2)+Math.pow(this._y-t.y,2))}static add(t,e,i){return t.set(e.x+i.x,e.y+i.y),t}static subtract(t,e,i){return t.set(e.x-i.x,e.y-i.y),t}static unit(t,e){return 0===e.magnitude?t.set(0,0):t.set(e.x/e.magnitude,e.y/e.magnitude),t}static normal(t,e){return t.set(-e.y,e.x),this.unit(t,t)}static scale(t,e,i){return t.set(e.x*i,e.y*i),t}static dot(t,e){return t.x*e.x+t.y*e.y}static cross(t,e){return t.x*e.y-t.y*e.x}static round(t,e){return t.set(Math.round(e.x),Math.round(e.y)),t}}class St{constructor(t,e,i,s){this._position=new Ot,this._center=new Ot,this._width=0,this._height=0,this.set(t,e,i,s)}get x(){return this._position.x}set x(t){this._position.set(t,this._position.y)}get y(){return this._position.y}set y(t){this._position.set(this._position.x,t)}get x1(){return this._position.x+this._width}get y1(){return this._position.y+this._height}get position(){return this._position}set position(t){this._position.set(t.x,t.y)}get width(){return this._width}set width(t){this._width=t}get height(){return this._height}set height(t){this._height=t}get center(){return this._center.set(this.x+this.width/2,this.y+this.height/2),this._center}set(t,e,i,s){this._position.set(t,e),this._width=i,this._height=s}equals(t){return this.position.equals(t.position)&&this.width===t.width&&this.height===t.height}copy(t){this.set(t.x,t.y,t.width,t.height)}overlaps(t){return this.x1>=t.x&&this.x<t.x1&&this.y1>=t.y&&this.y<t.y1}contains(t){return t instanceof St?t.x1<=this.x1&&t.x>=this.x&&t.y1<=this.y1&&t.y>=this.y:t instanceof Ot&&!(t.x<this.x||t.y<this.y||t.x>=this.x1||t.y>=this.y1)}}const At=(t,e,i)=>Math.min(i,Math.max(e,t));class Tt{constructor(){this.lastId=0}create({shape:t,layer:e,updateCollisions:i,physics:s,position:o,rotation:r,group:n,onCollision:a}){return{id:++this.lastId,active:!0,layer:e,shape:t,updateCollisions:i,physics:s,position:null!=o?o:new Ot,rotation:null!=r?r:0,group:n,onCollision:a}}}class Et{constructor(t,e=0){this.area=new St(0,0,0,0),this.depth=0,this.items=[],this.children=[],this.depth=e,this.resize(t)}resize(t){this.clear(),this.area.copy(t)}clear(){this.items=[],this.children.forEach((t=>t.clear())),this.children=[]}insert(t,e){0===this.children.length&&this.items.length>16&&this.depth<8&&this.split(),this.children.length>0?this.insertItemIntoChildren(t,e):this.items.push([t,e])}split(){const t=this.area.width/2,e=this.area.height/2;this.children=[new St(this.area.x,this.area.y,t,e),new St(this.area.x,this.area.y+e,t,e),new St(this.area.x+t,this.area.y+e,t,e),new St(this.area.x+t,this.area.y,t,e)].map((t=>new Et(t,this.depth+1))),this.items.forEach((t=>this.insertItemIntoChildren(t[0],t[1]))),this.items=[]}insertItemIntoChildren(t,e){this.getChildrenForArea(e).forEach((i=>i.insert(t,e)))}retrieve(t){const e=[];return this.children.length>0?this.getChildrenForArea(t).forEach((i=>e.push(...i.retrieve(t)))):this.items.forEach((t=>e.push(t[0]))),e}getChildrenForArea(t){const e=[];return t.x<=this.area.center.x&&t.y<=this.area.center.y&&e.push(this.children[0]),t.x<=this.area.center.x&&t.y1>=this.area.center.y&&e.push(this.children[1]),t.x1>=this.area.center.x&&t.y1>=this.area.center.y&&e.push(this.children[2]),t.x1>=this.area.center.x&&t.y<=this.area.center.y&&e.push(this.children[3]),e}}const Dt=(t,e,i,s)=>Math.min((t-e)/i|0,s-1);class Ft{constructor(t){this.coordinates={x0:0,x1:0,y0:0,y1:0},this._subdivisions=1,this.resize(t)}get subdivisions(){return this._subdivisions}set subdivisions(t){this._subdivisions=At(t,1,20)}resize(t){this.area=t,this.cellWidth=Math.ceil(t.width/this._subdivisions),this.cellHeight=Math.ceil(t.height/this._subdivisions),this.itemsInCells=[];for(let t=0;t<this._subdivisions;t++){this.itemsInCells[t]=[];for(let e=0;e<this._subdivisions;e++)this.itemsInCells[t][e]=[]}}clear(){for(let t=0;t<this._subdivisions;t++)for(let e=0;e<this._subdivisions;e++)this.itemsInCells[t][e]=[]}insert(t,e){this.updateCoordinates(e);for(let e=this.coordinates.x0;e<=this.coordinates.x1;e++)for(let i=this.coordinates.y0;i<=this.coordinates.y1;i++)this.itemsInCells[e][i].push(t)}retrieve(t){const e=[];this.updateCoordinates(t);for(let t=this.coordinates.x0;t<=this.coordinates.x1;t++)for(let i=this.coordinates.y0;i<=this.coordinates.y1;i++)this.itemsInCells[t][i].forEach((t=>e.includes(t)?null:e.push(t)));return e}updateCoordinates(t){this.coordinates.x0=Dt(t.x,this.area.x,this.cellWidth,this._subdivisions),this.coordinates.x1=Dt(t.x1,this.area.x,this.cellWidth,this._subdivisions),this.coordinates.y0=Dt(t.y,this.area.y,this.cellHeight,this._subdivisions),this.coordinates.y1=Dt(t.y1,this.area.y,this.cellHeight,this._subdivisions)}}var Bt,It,Lt,Ut;!function(t){t[t.QuadTree=0]="QuadTree",t[t.SpartialGrid=1]="SpartialGrid"}(Bt||(Bt={}));class Gt{constructor(t,e,i,s){this.collisions=[],this.lastCollidersAmount=0,this.minArea=new Ot,this.maxArea=new Ot,this.newArea=new St(0,0,0,0),this.method=t,this.colliders=[],this.activeColliders=[],this.collisionMatrix=s,this.setupBroadPhaseResolver(null!=e?e:Bt.QuadTree,i)}setupBroadPhaseResolver(t,e){this.collisionArea=null!=e?e:new St(0,0,0,0),this.fixedCollisionArea=!!e,t===Bt.SpartialGrid?this.broadPhaseResolver=new Ft(this.collisionArea):this.broadPhaseResolver=new Et(this.collisionArea)}addCollider(t){this.colliders[t.id]=t}getCollider(t){return this.colliders[t]}removeCollider(t){delete this.colliders[t.id]}clearColliders(){this.colliders=[]}getCollisionsForCollider(t){return t.active?this.collisions.filter((e=>e.localCollider.id===t.id)):[]}refreshCollisionsForCollider(t){this.colliders[t.id]&&t.active&&(this.collisions=this.collisions.filter((e=>e.localCollider.id!==t.id&&e.remoteCollider.id!==t.id)),this.updateShape(t),this.narrowPhase(t,this.broadPhase(t)))}resolve(){this.collisions=[],0!==this.colliders.length&&(this.activeColliders=this.colliders.filter((t=>t.active)),this.broadPhaseResolver.clear(),this.activeColliders.forEach((t=>{this.updateShape(t)})),!1===this.fixedCollisionArea&&(this.updateNewArea(),!1===this.newArea.equals(this.collisionArea)&&(this.collisionArea.copy(this.newArea),this.broadPhaseResolver.resize(this.collisionArea))),this.checkForSpartialGridResize(),this.activeColliders.forEach((({id:t,shape:{boundingBox:e}})=>this.broadPhaseResolver.insert(t,e))),this.updateCollisions())}updateShape(t){t.shape.position=t.position,t.shape.rotation=t.rotation,t.shape.update()}updateNewArea(){this.activeColliders.forEach((({shape:{boundingBox:t}})=>{this.minArea.set(Math.min(t.x,this.minArea.x),Math.min(t.y,this.minArea.y)),this.maxArea.set(Math.max(t.x1,this.maxArea.x),Math.max(t.y1,this.maxArea.y))})),this.newArea.set(this.minArea.x,this.minArea.y,this.maxArea.x-this.minArea.x,this.maxArea.y-this.minArea.y)}checkForSpartialGridResize(){this.broadPhaseResolver instanceof Ft&&this.lastCollidersAmount!==this.activeColliders.length&&(this.broadPhaseResolver.subdivisions=1+(this.activeColliders.length/10|0),this.broadPhaseResolver.resize(this.collisionArea),this.lastCollidersAmount=this.activeColliders.length)}updateCollisions(){this.activeColliders.filter((t=>t.updateCollisions)).forEach((t=>this.narrowPhase(t,this.broadPhase(t))))}broadPhase(t){return this.collisionMatrix?this.broadPhaseResolver.retrieve(t.shape.boundingBox).map((t=>this.colliders[t])).filter((e=>this.collisionMatrix.some((i=>i[0]===t.layer&&i[1]===e.layer||i[1]===t.layer&&i[0]===e.layer)))):this.broadPhaseResolver.retrieve(t.shape.boundingBox).map((t=>this.colliders[t]))}narrowPhase(t,e){e.filter((e=>!(t.group&&e.group&&e.group===t.group||t.id===e.id))).forEach((e=>{if(this.isResolved(t,e))return;const i=this.method.getCollisionResolution(t.shape,e.shape);null!==i&&(this.collisions.push({localCollider:t,remoteCollider:e,resolution:i},{localCollider:e,remoteCollider:t,resolution:{direction:i.displacementDirection,displacementDirection:i.direction,penetration:i.penetration}}),t.onCollision&&t.onCollision(i))}))}isResolved(t,e){for(const i of this.collisions)if(i.localCollider.id===t.id&&i.remoteCollider.id===e.id)return!0;return!1}}!function(t){t[t.Polygon=0]="Polygon",t[t.Circumference=1]="Circumference",t[t.Line=2]="Line"}(It||(It={}));class Vt{constructor(t,e,i){this.AABBResolver=t,this.circumferenceAABBResolver=e,this.circumferenceResolver=i}getCollisionResolution(t,e){return t.type===It.Polygon&&e.type===It.Polygon?this.AABBResolver.resolve(t,e):t.type===It.Circumference&&e.type===It.Polygon?this.circumferenceAABBResolver.resolve(t,e):t.type===It.Polygon&&e.type===It.Circumference?this.circumferenceAABBResolver.resolve(e,t,!0):t.type===It.Circumference&&e.type===It.Circumference?this.circumferenceResolver.resolve(t,e):null}}!function(t){t[t.AABB=0]="AABB",t[t.SAT=1]="SAT"}(Lt||(Lt={}));class kt{constructor(t,e){this.circumferenceResolver=t,this.satResolver=e}getCollisionResolution(t,e){return t.type===It.Circumference&&e.type===It.Circumference?this.circumferenceResolver.resolve(t,e):this.satResolver.resolve(t,e)}}class Wt{constructor(){this.direction=new Ot,this.displacementDirection=new Ot}resolve({boundingBox:t},{boundingBox:e}){return this.overlapX=Math.min(t.x1,e.x1)-Math.max(t.x,e.x),this.overlapY=Math.min(t.y1,e.y1)-Math.max(t.y,e.y),this.overlapX<0||this.overlapY<0?null:(this.checkOverlapForLines(t,e),this.direction.set(Math.sign(e.center.x-t.center.x),Math.sign(e.center.y-t.center.y)),this.preventContainment(t,e),this.overlapY<this.overlapX?(this.minOverlap=this.overlapY,this.displacementDirection.set(0,-this.direction.y)):(this.minOverlap=this.overlapX,this.displacementDirection.set(-this.direction.x,this.overlapY===this.overlapX?-this.direction.y:0)),Ot.unit(this.displacementDirection,this.displacementDirection),{direction:Ot.scale(new Ot,this.displacementDirection,-1),displacementDirection:this.displacementDirection.clone(),penetration:this.minOverlap})}checkOverlapForLines(t,e){0!==t.width&&0!==e.width||0!==this.overlapX||(this.overlapX=Math.min(Math.abs(t.x-e.x),Math.abs(t.x1-e.x1))),0!==t.height&&0!==e.height||0!==this.overlapY||(this.overlapY=Math.min(Math.abs(t.y-e.y),Math.abs(t.y1-e.y1)))}preventContainment(t,e){if(this.overlapY>0&&(t.y1>e.y1&&t.y<e.y||t.y1<e.y1&&t.y>e.y)){const i=Math.abs(t.y-e.y),s=Math.abs(t.y1-e.y1);this.overlapY+=i<s?i:s}if(this.overlapX>0&&(t.x1>e.x1&&t.x<e.x||t.x1<e.x1&&t.x>e.x)){const i=Math.abs(t.x-e.x),s=Math.abs(t.x1-e.x1);this.overlapX+=i<s?i:s}}}class Yt{constructor(){this.closestPoint=new Ot,this.distance=new Ot,this.direction=new Ot}resolve(t,e,i=!1){return this.closestPoint.set(At(t.position.x,e.boundingBox.x,e.boundingBox.x1),At(t.position.y,e.boundingBox.y,e.boundingBox.y1)),Ot.subtract(this.distance,this.closestPoint,t.position),this.distance.magnitude>t.radius?null:(Ot.unit(this.direction,this.distance),{direction:i?Ot.scale(new Ot,this.direction,-1):this.direction.clone(),displacementDirection:i?this.direction.clone():Ot.scale(new Ot,this.direction,-1),penetration:t.radius-this.distance.magnitude})}}class Ht{constructor(){this.distance=new Ot,this.direction=new Ot}resolve(t,e){return Ot.subtract(this.distance,e.position,t.position),this.distance.magnitude>t.radius+e.radius?null:(Ot.unit(this.direction,this.distance),{direction:this.direction.clone(),displacementDirection:Ot.scale(new Ot,this.direction,-1),penetration:t.radius+e.radius-this.distance.magnitude})}}class zt{constructor(){this.projA={min:0,max:0},this.projB={min:0,max:0},this.smallestAxis=new Ot,this.distance=new Ot(1/0,1/0),this.cache=new Ot}resolve(t,e){this.minOverlap=1/0,t.type===It.Circumference?this.setCircumferenceAxis(t,e):e.type===It.Circumference&&this.setCircumferenceAxis(e,t),this.axes=[...t.projectionAxes],e.projectionAxes.forEach((t=>this.axes.some((e=>e.equals(t)))?null:this.axes.push(t)));for(let i=0;i<this.axes.length;i++){if(t.type===It.Circumference?this.setCircumferenceVertices(t,this.axes[i]):e.type===It.Circumference&&this.setCircumferenceVertices(e,this.axes[i]),this.projectShapeOntoAxis(this.projA,t,this.axes[i]),this.projectShapeOntoAxis(this.projB,e,this.axes[i]),this.currentOverlap=Math.min(this.projA.max,this.projB.max)-Math.max(this.projA.min,this.projB.min),this.currentOverlap<0)return null;if(this.invertAxis=!0,this.projA.max>this.projB.max&&this.projA.min<this.projB.min||this.projA.max<this.projB.max&&this.projA.min>this.projB.min){const t=Math.abs(this.projA.min-this.projB.min),e=Math.abs(this.projA.max-this.projB.max);t<e?this.currentOverlap+=t:(this.currentOverlap+=e,Ot.scale(this.axes[i],this.axes[i],-1),this.invertAxis=!1)}this.currentOverlap<this.minOverlap&&(this.minOverlap=this.currentOverlap,this.smallestAxis.copy(this.axes[i]),this.invertAxis&&this.projA.max<this.projB.max&&Ot.scale(this.smallestAxis,this.axes[i],-1))}return{direction:Ot.scale(new Ot,this.smallestAxis,-1),displacementDirection:this.smallestAxis.clone(),penetration:this.minOverlap}}projectShapeOntoAxis(t,e,i){return t.min=1/0,t.max=-1/0,e.vertices.forEach((e=>{t.min=Math.min(Ot.dot(i,e),t.min),t.max=Math.max(Ot.dot(i,e),t.max)})),t}setCircumferenceAxis(t,e){this.distance.set(1/0,1/0),e.vertices.forEach((e=>{Ot.subtract(this.cache,e,t.position),this.cache.magnitude<this.distance.magnitude&&this.distance.copy(this.cache)})),Ot.unit(t.projectionAxes[0],this.distance)}setCircumferenceVertices(t,e){Ot.add(t.vertices[0],t.position,Ot.scale(this.cache,Ot.unit(this.cache,e),-t.radius)),Ot.add(t.vertices[1],t.position,Ot.scale(this.cache,Ot.unit(this.cache,e),t.radius))}}class Nt{constructor(t,e,i,s){this.collisionManager=t,this.colliderFactory=e,this.rigidBodyManager=i,this.rigidBodyFactory=s}addCollider(t){const e=this.colliderFactory.create(t);return this.collisionManager.addCollider(e),e}removeCollider(t){this.collisionManager.removeCollider(t)}getCollisionsForCollider(t){return this.collisionManager.getCollisionsForCollider(t)}addRigidBody(t){const e=this.rigidBodyFactory.create(t);return this.rigidBodyManager.addRigidBody(e),e}removeRigidBody(t){this.rigidBodyManager.removeRigidBody(t)}resolve(t){this.collisionManager.resolve(),this.rigidBodyManager.resolve(t)}clear(){this.collisionManager.clearColliders(),this.rigidBodyManager.clearRigidBodies()}}class Xt{constructor(){this.lastId=0}create({colliderIds:t,type:e,gravity:i,position:s,velocity:o,onResolve:r}){if(0===t.length)throw new Error("RigidBody needs at least one collider");return{id:++this.lastId,active:!0,colliderIds:t,type:e,gravity:null!=i?i:0,position:null!=s?s:new Ot,velocity:null!=o?o:new Ot,onResolve:r}}}!function(t){t[t.Static=0]="Static",t[t.Dynamic=1]="Dynamic",t[t.Kinematic=2]="Kinematic"}(Ut||(Ut={}));const qt=["x","y"];class Kt{constructor(t){this.collisionManager=t,this.rigidBodies=[],this.activeRigidBodies=[],this.colliders=[],this.velocity=new Ot,this.displacement=new Ot,this.cacheDisplacement=0}addRigidBody(t){this.rigidBodies[t.id]=t}removeRigidBody(t){delete this.rigidBodies[t.id]}clearRigidBodies(){this.rigidBodies=[]}resolve(t){this.activeRigidBodies=this.rigidBodies.filter((t=>t.active)),this.colliders=this.activeRigidBodies.reduce(((t,e)=>[...t,...e.colliderIds]),[]),this.activeRigidBodies.forEach((e=>{e.type===Ut.Dynamic?this.dynamicUpdate(e,t):e.type===Ut.Kinematic&&this.kinematicUpdate(e,t),e.onResolve&&e.onResolve(e)}))}dynamicUpdate(t,e){this.applyGravity(t,e),qt.forEach((i=>{this.applyVelocity(t,e,i),this.obtainDisplacement(t,i),this.applyReposition(t,i)}))}kinematicUpdate(t,e){Ot.add(t.position,t.position,Ot.scale(this.velocity,t.velocity,e)),t.colliderIds.map((t=>this.collisionManager.getCollider(t))).forEach((t=>{Ot.add(t.position,t.position,this.velocity),this.collisionManager.refreshCollisionsForCollider(t)}))}applyGravity(t,e){t.gravity>0&&(t.velocity.y-=t.gravity*e)}applyVelocity(t,e,i){this.velocity[i]=t.velocity[i]*e,0!==this.velocity[i]&&(t.position[i]+=this.velocity[i],t.colliderIds.map((t=>this.collisionManager.getCollider(t))).forEach((t=>{t.position[i]+=this.velocity[i],this.collisionManager.refreshCollisionsForCollider(t)})))}obtainDisplacement(t,e){this.displacement[e]=0,this.getCollisions(t).forEach((t=>{this.cacheDisplacement=t.resolution.displacementDirection[e]*t.resolution.penetration,this.displacement[e]=Math.abs(this.displacement[e])>Math.abs(this.cacheDisplacement)?this.displacement[e]:this.cacheDisplacement}))}applyReposition(t,e){0!==this.displacement[e]&&(t.position[e]+=this.displacement[e],t.colliderIds.map((t=>this.collisionManager.getCollider(t))).forEach((t=>{t.position[e]+=this.displacement[e],this.collisionManager.refreshCollisionsForCollider(t)})),Math.sign(this.displacement[e])!==Math.sign(t.velocity[e])&&(t.velocity[e]=0))}getCollisions(t){return t.colliderIds.map((t=>this.collisionManager.getCollider(t))).filter((t=>t.active&&t.physics)).reduce(((t,e)=>(t.push(...this.collisionManager.getCollisionsForCollider(e).filter((t=>t.remoteCollider.physics&&this.colliders.includes(t.remoteCollider.id)))),t)),[])}}class $t{constructor(t){this.radius=t,this.type=It.Circumference,this.boundingBox=new St(0,0,0,0),this.vertices=[new Ot,new Ot],this.projectionAxes=[new Ot],this._position=new Ot}set position(t){this._position.copy(t)}get position(){return this._position}update(){this.updateBoundingBox()}updateBoundingBox(){this.boundingBox.set(this.position.x-this.radius,this.position.y-this.radius,2*this.radius,2*this.radius)}}class Qt{constructor(t){this.vertexModel=t,this.type=It.Polygon,this.vertices=[new Ot,new Ot],this.projectionAxes=[new Ot],this.boundingBox=new St(0,0,0,0),this.rotation=0,this._position=new Ot}update(){this.updateVertices(),this.updateBoundingBox(),this.updateProjectionAxes()}set position(t){this._position.copy(t)}get position(){return this._position}updateVertices(){for(let t=0;t<this.vertexModel.length;t++)this.vertices[t].set(this.vertexModel[t].x*Math.cos(this.rotation)-this.vertexModel[t].y*Math.sin(this.rotation)+this._position.x,this.vertexModel[t].x*Math.sin(this.rotation)+this.vertexModel[t].y*Math.cos(this.rotation)+this._position.y)}updateBoundingBox(){this.boundingBox.x=Math.min(this.vertices[0].x,this.vertices[1].x),this.boundingBox.y=Math.min(this.vertices[0].y,this.vertices[1].y),this.boundingBox.width=Math.max(this.vertices[0].x,this.vertices[1].x)-this.boundingBox.x,this.boundingBox.height=Math.max(this.vertices[0].y,this.vertices[1].y)-this.boundingBox.y}updateProjectionAxes(){Ot.normal(this.projectionAxes[0],Ot.subtract(this.projectionAxes[0],this.vertices[1],this.vertices[0]))}}class Jt{constructor(t){this.vertexModel=t,this.type=It.Polygon,this.vertices=[],this.boundingBox=new St(0,0,0,0),this.rotation=0,this._projectionAxes=[],this._position=new Ot,this.boxMinX=Number.MAX_SAFE_INTEGER,this.boxMinY=Number.MAX_SAFE_INTEGER,this.boxMaxX=-Number.MAX_SAFE_INTEGER,this.boxMaxY=-Number.MAX_SAFE_INTEGER;for(let t=0;t<this.vertexModel.length;t++)this.vertices.push(new Ot),this._projectionAxes.push(new Ot)}set position(t){this._position.copy(t)}get position(){return this._position}get projectionAxes(){return this._projectionAxes}update(){this.updateVertices(),this.updateBoundingBox(),this.updateProjectionAxes()}updateVertices(){for(let t=0;t<this.vertexModel.length;t++)this.vertices[t].set(this.vertexModel[t].x*Math.cos(this.rotation)-this.vertexModel[t].y*Math.sin(this.rotation)+this._position.x,this.vertexModel[t].x*Math.sin(this.rotation)+this.vertexModel[t].y*Math.cos(this.rotation)+this._position.y)}updateBoundingBox(){this.boxMinX=this.vertices[0].x,this.boxMinY=this.vertices[0].y,this.boxMaxX=this.vertices[0].x,this.boxMaxY=this.vertices[0].y,this.vertices.forEach((t=>{this.boxMinX=Math.min(t.x,this.boxMinX),this.boxMinY=Math.min(t.y,this.boxMinY),this.boxMaxX=Math.max(t.x,this.boxMaxX),this.boxMaxY=Math.max(t.y,this.boxMaxY)})),this.boundingBox.set(this.boxMinX,this.boxMinY,this.boxMaxX-this.boxMinX,this.boxMaxY-this.boxMinY)}updateProjectionAxes(){var t;for(let e=0;e<this.vertices.length;e++)Ot.normal(this._projectionAxes[e],Ot.subtract(this._projectionAxes[e],null!==(t=this.vertices[e+1])&&void 0!==t?t:this.vertices[0],this.vertices[e]))}}class Zt extends Jt{constructor(t,e){super([new Ot(-t/2,-e/2),new Ot(-t/2,e/2),new Ot(t/2,e/2),new Ot(t/2,-e/2)]),this.width=t,this.height=e,this._projectionAxes=[new Ot,new Ot]}updateSize(t,e){this.width=t,this.height=e,this.vertexModel[0].set(-t/2,-e/2),this.vertexModel[1].set(-t/2,e/2),this.vertexModel[2].set(t/2,e/2),this.vertexModel[3].set(t/2,-e/2)}updateProjectionAxes(){Ot.unit(this.projectionAxes[0],Ot.subtract(this.projectionAxes[0],this.vertices[1],this.vertices[0])),Ot.normal(this.projectionAxes[1],this.projectionAxes[0])}}var te,ee=function(t){var e=t.getSingleton("DomManager");t.add("InputManager",(function(){return new G(new k(e.canvas),new V(e.canvas),new L,new z(e.canvas))}))},ie=function(){function t(){this.instances=new Map,this.constructors=new Map,this.constants=new Map}return t.prototype.add=function(t,e){if(this.constructors.has(t))throw new F("There is already an object constructor with the name ".concat(t));this.constructors.set(t,e)},t.prototype.getSingleton=function(t){if(!1===this.constructors.has(t))throw new F("Invalid object constructor name: ".concat(t));return!1===this.instances.has(t)&&this.instances.set(t,this.constructors.get(t)()),this.instances.get(t)},t.prototype.getTranscient=function(t){if(!1===this.constructors.has(t))throw new F("Invalid object constructor name: ".concat(t));return this.constructors.get(t)()},t.prototype.addConstant=function(t,e){if(this.constants.has(t))throw new F("There is already a constant value with the name ".concat(t));this.constants.set(t,e)},t.prototype.getConstant=function(t){if(!1===this.constants.has(t))throw new F("Invalid constant name: ".concat(t));return this.constants.get(t)},t}(),se={containerNode:null,gameWidth:320,gameHeight:180,debugEnabled:!1,canvasColor:"#000000",physicsFramerate:180,headless:!1,spriteDefaultScale:new s(1,1),collisions:{collisionMethod:Lt.SAT,collisionBroadPhaseMethod:Bt.SpartialGrid}},oe=function(){function t(t){this._config=m(m({},se),t),this._config.collisions=m(m({},se.collisions),t.collisions),this.container=new ie,this.container.addConstant("Game",this),this.setupManagers()}return t.prototype.setupManagers=function(){(function(t,e){t.addConstant("GameConfig",e),t.add("TimeManager",(function(){return new H(e.physicsFramerate)})),t.add("GameObjectManager",(function(){return new I(t)})),t.add("PhysicsManager",(function(){return(({collisionArea:t,collisionMatrix:e,collisionMethod:i,collisionBroadPhaseMethod:s}={})=>{const o=new Ht,r=i===Lt.AABB?new Vt(new Wt,new Yt,o):new kt(o,new zt),n=new Gt(r,s,t,e),a=new Tt,h=new Kt(n),l=new Xt;return new Nt(n,a,h,l)})(e.collisions)})),e.headless?t.add("IterationManager",(function(){return new N(t.getSingleton("TimeManager"),t.getSingleton("PhysicsManager"),t.getSingleton("GameObjectManager"),t.getSingleton("SceneManager"))})):(t.add("DomManager",(function(){return new B(e.containerNode,e.gameWidth,e.gameHeight)})),t.add("RenderManager",(function(){return(t=>{const e=new $(t),i=e.gl,s=e.contextVersion,o=new tt(i,s,new Z(i,new et(i))),r=new Pt(new jt(i)),n=new Rt(i,o,r,new Map([[A.Sprite,new ft(i,o,r)],[A.Text,new wt(i,o,r,new Q)],[A.Tilemap,new Ct(i,o,r)],[A.Geometric,new gt(i,o)],[A.Mask,new mt(i,o)],[A.Video,new _t(i,o,r)]]));return new K(n,new X(i))})(t.getSingleton("DomManager").canvas)})),ee(t),t.add("AssetManager",(function(){return new D(t.getSingleton("RenderManager"))})),t.add("IterationManager",(function(){return new v(t.getSingleton("TimeManager"),t.getSingleton("PhysicsManager"),t.getSingleton("RenderManager"),t.getSingleton("InputManager"),t.getSingleton("GameObjectManager"),t.getSingleton("SceneManager"),e.canvasColor)}))),t.add("SceneManager",(function(){return new W(t,e.headless?void 0:t.getSingleton("RenderManager"))}))})(this.container,this._config),this.sceneManager=this.container.getSingleton("SceneManager"),this.iterationManager=this.container.getSingleton("IterationManager")},Object.defineProperty(t.prototype,"config",{get:function(){return this._config},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"running",{get:function(){return this.iterationManager.running},enumerable:!1,configurable:!0}),t.prototype.addScene=function(t,e,i,s){void 0===s&&(s=!1),this.sceneManager.addScene(t,e,i,s)},t.prototype.run=function(){this.iterationManager.start()},t.prototype.stop=function(){this.iterationManager.stop()},t.prototype.pause=function(){this.iterationManager.pause()},t.prototype.resume=function(){this.iterationManager.resume()},t}(),re=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.allowMultiple=!1,e.parentScale=!0,e.parentRotation=!0,e._position=new s,e._scale=new s(1,1),e._rotation=new d,e._innerPosition=new s,e._parent=null,e.cache=new s,e.lastParentRadians=0,e.lastPosition=new s,e.scaledInnerPosition=new s,e}return p(e,t),Object.defineProperty(e.prototype,"position",{get:function(){return this._position},set:function(t){this._position.copy(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this._scale},set:function(t){this._scale.copy(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this._rotation},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"direction",{get:function(){return this._rotation.direction},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"innerPosition",{get:function(){return this._innerPosition},set:function(t){this._innerPosition.copy(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},set:function(t){this._parent=t,null!==this._parent&&s.subtract(this._innerPosition,this._position,this._parent.position)},enumerable:!1,configurable:!0}),e.prototype.update=function(){null!==this._parent&&this.setPositionFromParent(),this.lastPosition.copy(this._position)},e.prototype.setPositionFromParent=function(){this._innerPosition.magnitude>0?(0!==this._parent.rotation.radians&&this.lastParentRadians!==this._parent.rotation.radians&&(this.translateInnerPosition(),this.lastParentRadians=this._parent.rotation.radians),this.parentScale?(this.updateScaledInnerPosition(),s.add(this._position,this._parent.position,this.scaledInnerPosition)):s.add(this._position,this._parent.position,this._innerPosition)):this._position.copy(this._parent.position),this._rotation.radians=this.parentRotation?this._parent.rotation.radians+this._rotation.radians:this._rotation.radians,this.parentScale&&this._scale.copy(this.parent._scale)},e.prototype.translateInnerPosition=function(){var t=Math.atan2(this._innerPosition.y,this._innerPosition.x)+(this._parent.rotation.radians-this.lastParentRadians);this.cache.set(Math.cos(t),Math.sin(t)),s.scale(this._innerPosition,this.cache,this._innerPosition.magnitude)},e.prototype.updateScaledInnerPosition=function(){this.scaledInnerPosition.set(this._innerPosition.x*this._parent.scale.x,this._innerPosition.y*this._parent.scale.y)},e}(_),ne=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.renderer=null,e.colliders=[],e.physics=!0,e.activateColliders=!1,e}return p(e,t),e.prototype.update=function(){this.activateColliders&&(this.colliders.forEach((function(t){return t.active=!0})),this.activateColliders=!1),this.updateRealSize(),this.updatePosition(),this.updateColliders()},e.prototype.collidesWithLayer=function(t){return null!==this.getCollisionWithLayer(t)},e.prototype.getCollisionWithLayer=function(t){for(var e=0,i=this.colliders;e<i.length;e++)for(var s=i[e],o=0,r=this.physicsManager.getCollisionsForCollider(s);o<r.length;o++){var n=r[o];if(n.remoteCollider.layer===t)return this.createCollisionData(n)}return null},e.prototype.getCollisionsWithLayer=function(t){for(var e=[],i=0,s=this.colliders;i<s.length;i++)for(var o=s[i],r=0,n=this.physicsManager.getCollisionsForCollider(o);r<n.length;r++){var a=n[r];a.remoteCollider.layer===t&&e.push(this.createCollisionData(a))}return e},e.prototype.createCollisionData=function(t){return{gameObject:this.gameObjectManager.findGameObjectById(Number(t.remoteCollider.group)),collider:t.remoteCollider,resolution:t.resolution,getGameObject:function(){return this.gameObject}}},e.prototype.onActiveChange=function(){var t=this;this.renderer&&(this.renderer.active=this.active),this.active?this.activateColliders=!0:this.colliders.forEach((function(e){return e.active=t.active}))},e.prototype.onDestroy=function(){var t=this;this.colliders.forEach((function(e){return t.physicsManager.removeCollider(e)}))},e}(w),ae=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.allowMultiple=!1,e}return p(e,t),Object.defineProperty(e.prototype,"velocity",{get:function(){return this.rigidBody.velocity},set:function(t){this.rigidBody.velocity.copy(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gravity",{get:function(){return this.rigidBody.gravity},set:function(t){this.rigidBody.gravity=Math.abs(t)},enumerable:!1,configurable:!0}),e.prototype.init=function(t){var e,i=t.rigidBodyType,o=t.gravity;if(0===this.getColliderIds().length)throw new F("RigidBody needs at least one Collider with physics");this.rigidBody=this.physicsManager.addRigidBody({type:i,colliderIds:this.getColliderIds(),gravity:null!==(e=Math.abs(o))&&void 0!==e?e:0,velocity:new s,position:new s})},e.prototype.update=function(){if(0===this.getColliderIds().length)throw new F("RigidBody needs at least one Collider with physics");this.rigidBody.colliderIds=this.getColliderIds(),this.rigidBody.position=this.gameObject.transform.parent?this.gameObject.transform.innerPosition:this.gameObject.transform.position},e.prototype.getColliderIds=function(){return this.gameObject.getComponents().filter((function(t){return t instanceof ne&&t.physics})).reduce((function(t,e){return f(f([],t,!0),e.colliders.map((function(t){return t.id})),!0)}),[])},e.prototype.onActiveChange=function(){this.rigidBody.active=this.active},e.prototype.onDestroy=function(){this.physicsManager.removeRigidBody(this.rigidBody)},e}(M),he="Default",le=function(t){function e(e,i,s,o){void 0===s&&(s=""),void 0===o&&(o=null);var r=t.call(this,e)||this;return r.layer="Default",r.ui=!1,r.keep=!1,r._parent=null,r._active=!0,r.components=[],r.activeComponentsCache=[],r.activeChildrenCache=[],r.id=i,r.name=s,r.addComponent(re),r.parent=o,r}return p(e,t),Object.defineProperty(e.prototype,"active",{get:function(){return this._active},set:function(t){this._active!==t&&(this._active=t,this.updateComponentsActiveStatus(),this.updateChildrenActiveStatus(),this.onActiveChange())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},set:function(t){this._parent=t,this.transform.parent=null!==t?t.transform:null},enumerable:!1,configurable:!0}),e.prototype.updateComponentsActiveStatus=function(){var t=this;!1===this.active&&(this.activeComponentsCache=this.components.filter((function(t){return t.active}))),this.activeComponentsCache.forEach((function(e){return e.active=t.active})),!0===this.active&&(this.activeComponentsCache=[])},e.prototype.updateChildrenActiveStatus=function(){var t=this;!1===this.active&&(this.activeChildrenCache=this.getChildren().filter((function(t){return t.active}))),this.activeChildrenCache.forEach((function(e){return e.active=t.active})),!0===this.active&&(this.activeChildrenCache=[])},Object.defineProperty(e.prototype,"transform",{get:function(){return this.getComponent(re)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rigidBody",{get:function(){return this.getComponent(ae)},enumerable:!1,configurable:!0}),e.prototype.onActiveChange=function(){},e.prototype.getCurrentScene=function(){return this.sceneManager.getCurrentScene()},e.prototype.addComponent=function(t,e,i){var s="string"==typeof e?void 0:e,o="string"==typeof e?e:i,r=new t(this.container,this,o);return this.checkMultipleComponent(r,t),this.components.push(r),r.dispatch(g.Init,s),r},e.prototype.checkMultipleComponent=function(t,e){if(!1===t.allowMultiple&&this.hasComponent(e))throw new F("GameObject only allows one component of type ".concat(e.name))},e.prototype.getComponents=function(t){return t?this.components.filter((function(e){return e instanceof t})):this.components},e.prototype.getComponent=function(t){return"string"==typeof t?this.components.find((function(e){return e.name===t})):this.components.find((function(e){return e instanceof t}))},e.prototype.hasComponent=function(t){return"string"==typeof t?this.components.some((function(e){return e.name===t})):this.components.some((function(e){return e instanceof t}))},e.prototype.removeComponent=function(t){var e=this.components.indexOf(t);-1!==e&&this.components.splice(e,1)[0].dispatch(g.Destroy)},e.prototype.addChild=function(t,e,i){var s=this.gameObjectManager.addGameObject(t,e,this,i);return s.transform.innerPosition.set(0,0),s.transform.position.copy(this.transform.position),s},e.prototype.getChildren=function(){return this.gameObjectManager.findGameObjectsByParent(this)},e.prototype.getChild=function(t){return this.gameObjectManager.findGameObjectByParent(this,t)},e.prototype.destroyChildren=function(){var t=this;this.gameObjectManager.findGameObjectsByParent(this).forEach((function(e){return t.gameObjectManager.destroyGameObject(e)}))},e.prototype._destroy=function(){var t=this;this.destroyComponents(),Object.keys(this).forEach((function(e){return delete t[e]}))},e.prototype.destroyComponents=function(){for(var t=0;t<this.components.length;t++)this.components[t].dispatch(g.Destroy),delete this.components[t];this.components=[]},e.prototype._stopGame=function(){},e}(x),ce=["Default"],de=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.allowMultiple=!1,e.viewportRect=new o(0,0,0,0),e.worldSpaceRect=new o(0,0,0,0),e.depth=0,e.layers=ce,e._zoom=1,e}return p(e,t),Object.defineProperty(e.prototype,"zoom",{get:function(){return this._zoom},set:function(t){if(this.zoom<=0)throw new F("zoom must be greather than 0");this._zoom=t},enumerable:!1,configurable:!0}),e.prototype.addLayer=function(t){this.layers.push(t)},e.prototype.init=function(){this.canvas=this.domManager.canvas,this.cameraData={position:new s,layers:[],depth:1}},e.prototype.update=function(){this.updateViewportRect(),this.updateWorldSpaceRect(),this.updateCameraData()},e.prototype.updateViewportRect=function(){this.viewportRect.x=-this.canvas.width/2,this.viewportRect.y=-this.canvas.height/2,this.viewportRect.width=this.canvas.width,this.viewportRect.height=this.canvas.height},e.prototype.updateWorldSpaceRect=function(){this.worldSpaceRect.x=(this.gameObject.transform.position.x-this.viewportRect.width/2)/this._zoom,this.worldSpaceRect.y=(this.gameObject.transform.position.y-this.viewportRect.height/2)/this._zoom,this.worldSpaceRect.width=this.viewportRect.width/this._zoom,this.worldSpaceRect.height=this.viewportRect.height/this._zoom},e.prototype.updateCameraData=function(){this.cameraData.position.copy(this.gameObject.transform.position),this.cameraData.depth=this.depth,this.cameraData.layers=this.layers,this.cameraData.zoom=this._zoom,this.renderManager.addCameraData(this.cameraData)},e}(P),ue=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.init=function(){this.transform.position.set(0,0),this.camera=this.addComponent(de)},Object.defineProperty(e.prototype,"layers",{get:function(){return this.camera.layers},set:function(t){this.camera.layers=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"depth",{get:function(){return this.camera.depth},set:function(t){this.camera.depth=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"zoom",{get:function(){return this.camera.zoom},set:function(t){this.camera.zoom=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldSpaceRect",{get:function(){return this.camera.worldSpaceRect},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewportRect",{get:function(){return this.camera.viewportRect},enumerable:!1,configurable:!0}),e.prototype.addLayer=function(t){this.camera.layers.push(t)},e}(le),pe=function(t){function e(e,i,s){var o=t.call(this,e)||this;return o.name=i,o.game=s,o.game.config.headless||o.addGameObject(ue),o}return p(e,t),Object.defineProperty(e.prototype,"gameCamera",{get:function(){return this.findGameObject(ue)},enumerable:!1,configurable:!0}),e.prototype._destroy=function(){var t=this;this.gameObjectManager.destroyAllGameObjects(!1),Object.keys(this).forEach((function(e){return delete t[e]}))},e.prototype._stopGame=function(){var t=this;this.gameObjectManager.destroyAllGameObjects(!0),Object.keys(this).forEach((function(e){return delete t[e]}))},e}(x),ge=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.debug=!1,e.offsetX=0,e.offsetY=0,e.scaledVertexModel=[],e.scaledOffset=new s,e.scaledPosition=new s,e.finalRotation=0,e.innerPosition=new s,e}return p(e,t),e.prototype.init=function(t){var e,i,o,r,n,a;if(this.gameConfig.collisions.collisionMethod!==Lt.SAT)throw new F("Polygon Colliders need SAT collision method.");if(t.vertexModel.length<3)throw new F("Polygon Collider needs at least 3 vertices.");this.debug=(null!==(e=t.debug)&&void 0!==e?e:this.debug)&&this.gameConfig.debugEnabled,this.vertexModel=t.vertexModel,this.offsetX=null!==(i=t.offsetX)&&void 0!==i?i:this.offsetX,this.offsetY=null!==(o=t.offsetY)&&void 0!==o?o:this.offsetY,this.physics=null!==(r=t.physics)&&void 0!==r?r:this.physics,this.rotation=null!==(n=t.rotation)&&void 0!==n?n:new d,this.layer=t.layer;for(var h=0;h<this.vertexModel.length;h++)this.scaledVertexModel.push(new s);this.colliders.push(this.physicsManager.addCollider({layer:null!==(a=this.layer)&&void 0!==a?a:this.gameObject.layer,position:this.gameObject.transform.position.clone(),rotation:this.rotation.radians,shape:new Jt(this.scaledVertexModel),updateCollisions:!0,physics:this.physics,group:this.gameObject.id.toString()})),this.debug&&(this.renderer=this.gameObject.addComponent(me,{collider:this.colliders[0]}))},e.prototype.updateRealSize=function(){var t=this;this.vertexModel.forEach((function(e,i){return t.scaledVertexModel[i].set(e.x*t.gameObject.transform.scale.x,e.y*t.gameObject.transform.scale.y)})),this.scaledOffset.x=this.offsetX*this.gameObject.transform.scale.x,this.scaledOffset.y=this.offsetY*this.gameObject.transform.scale.y,this.finalRotation=this.gameObject.transform.rotation.radians+this.rotation.radians},e.prototype.updatePosition=function(){s.add(this.scaledPosition,this.gameObject.transform.position,this.scaledOffset),0!==this.gameObject.transform.rotation.radians&&this.translate()},e.prototype.translate=function(){s.subtract(this.innerPosition,this.scaledPosition,this.gameObject.transform.position);var t=Math.atan2(this.innerPosition.y,this.innerPosition.x)+this.gameObject.transform.rotation.radians;this.scaledPosition.set(this.gameObject.transform.position.x+this.innerPosition.magnitude*Math.cos(t),this.gameObject.transform.position.y+this.innerPosition.magnitude*Math.sin(t))},e.prototype.updateColliders=function(){var t;this.colliders[0].layer=null!==(t=this.layer)&&void 0!==t?t:this.gameObject.layer,this.colliders[0].position.copy(this.scaledPosition),this.colliders[0].rotation=this.finalRotation,this.colliders[0].shape.vertexModel=this.scaledVertexModel},e}(ne),me=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.init=function(t){var e=t.collider;this.renderData={type:A.Geometric,location:S.WorldSpace,layer:this.gameObject.layer,position:new s,shape:O.Polygon,color:"#00FF00"},this.collider=e},e.prototype.update=function(){this.renderData.layer=this.gameObject.layer,this.renderData.position.copy(this.collider.position),this.renderData.rotation=this.collider.shape.rotation,this.renderData.vertexModel=this.collider.shape.vertexModel,this.renderManager.addRenderData(this.renderData)},e}(R),fe=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.debug=!1,e.offsetX=0,e.offsetY=0,e.realWidth=0,e.realHeight=0,e.realOffset=new s,e.realPosition=new s,e.realRotation=0,e.applyRotation=e.gameConfig.collisions.collisionMethod===Lt.SAT,e.innerPosition=new s,e}return p(e,t),e.prototype.init=function(t){var e,i,s,o,r,n;this.width=t.width,this.height=t.height,this.offsetX=null!==(e=t.offsetX)&&void 0!==e?e:this.offsetX,this.offsetY=null!==(i=t.offsetY)&&void 0!==i?i:this.offsetY,this.physics=null!==(s=t.physics)&&void 0!==s?s:this.physics,this.debug=(null!==(o=t.debug)&&void 0!==o?o:this.debug)&&this.gameConfig.debugEnabled,this.rotation=null!==(r=t.rotation)&&void 0!==r?r:new d,this.layer=t.layer,this.colliders.push(this.physicsManager.addCollider({layer:null!==(n=this.layer)&&void 0!==n?n:this.gameObject.layer,position:this.gameObject.transform.position.clone(),rotation:this.rotation.radians,shape:new Zt(this.realWidth,this.realHeight),updateCollisions:!0,physics:this.physics,group:this.gameObject.id.toString()})),this.debug&&(this.renderer=this.gameObject.addComponent(me,{collider:this.colliders[0]}))},e.prototype.updateRealSize=function(){this.realWidth=this.width*Math.abs(this.gameObject.transform.scale.x),this.realHeight=this.height*Math.abs(this.gameObject.transform.scale.y),this.realOffset.x=this.offsetX*this.gameObject.transform.scale.x,this.realOffset.y=this.offsetY*this.gameObject.transform.scale.y,this.realRotation=this.applyRotation?this.gameObject.transform.rotation.radians+this.rotation.radians:0},e.prototype.updatePosition=function(){s.add(this.realPosition,this.gameObject.transform.position,this.realOffset),0!==this.gameObject.transform.rotation.radians&&this.translate()},e.prototype.translate=function(){s.subtract(this.innerPosition,this.realPosition,this.gameObject.transform.position);var t=Math.atan2(this.innerPosition.y,this.innerPosition.x)+this.gameObject.transform.rotation.radians;this.realPosition.set(this.gameObject.transform.position.x+this.innerPosition.magnitude*Math.cos(t),this.gameObject.transform.position.y+this.innerPosition.magnitude*Math.sin(t))},e.prototype.updateColliders=function(){var t;this.colliders[0].layer=null!==(t=this.layer)&&void 0!==t?t:this.gameObject.layer,this.colliders[0].position.copy(this.realPosition),this.colliders[0].rotation=this.realRotation,this.colliders[0].shape.updateSize(this.realWidth,this.realHeight)},e}(ne),ye=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.debug=!1,e.offsetX=0,e.offsetY=0,e.realRadius=0,e.realOffset=new s,e.realPosition=new s,e.innerPosition=new s,e}return p(e,t),e.prototype.init=function(t){var e,i,s,o,r;this.radius=t.radius,this.offsetX=null!==(e=t.offsetX)&&void 0!==e?e:this.offsetX,this.offsetY=null!==(i=t.offsetY)&&void 0!==i?i:this.offsetY,this.physics=null!==(s=t.physics)&&void 0!==s?s:this.physics,this.debug=(null!==(o=t.debug)&&void 0!==o?o:this.debug)&&this.gameConfig.debugEnabled,this.layer=t.layer,this.colliders.push(this.physicsManager.addCollider({layer:null!==(r=this.layer)&&void 0!==r?r:this.gameObject.layer,position:this.gameObject.transform.position.clone(),shape:new $t(this.radius),updateCollisions:!0,physics:this.physics,group:this.gameObject.id.toString()})),this.debug&&(this.renderer=this.gameObject.addComponent(ve,{collider:this.colliders[0]}))},e.prototype.updateRealSize=function(){this.realRadius=this.radius*Math.max(Math.abs(this.gameObject.transform.scale.x),Math.abs(this.gameObject.transform.scale.y)),this.realOffset.x=this.offsetX*this.gameObject.transform.scale.x,this.realOffset.y=this.offsetY*this.gameObject.transform.scale.y},e.prototype.updatePosition=function(){s.add(this.realPosition,this.gameObject.transform.position,this.realOffset),0!==this.gameObject.transform.rotation.radians&&this.translate()},e.prototype.translate=function(){s.subtract(this.innerPosition,this.realPosition,this.gameObject.transform.position);var t=Math.atan2(this.innerPosition.y,this.innerPosition.x)+this.gameObject.transform.rotation.radians;this.realPosition.set(this.gameObject.transform.position.x+this.innerPosition.magnitude*Math.cos(t),this.gameObject.transform.position.y+this.innerPosition.magnitude*Math.sin(t))},e.prototype.updateColliders=function(){var t;this.colliders[0].layer=null!==(t=this.layer)&&void 0!==t?t:this.gameObject.layer,this.colliders[0].position.copy(this.realPosition),this.colliders[0].shape.radius=this.realRadius},e}(ne),ve=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.init=function(t){var e=t.collider;this.renderData={type:A.Geometric,location:S.WorldSpace,layer:this.gameObject.layer,position:new s,shape:O.Circumference,color:"#00FF00"},this.collider=e},e.prototype.update=function(){this.renderData.layer=this.gameObject.layer,this.renderData.position.copy(this.collider.position),this.renderData.radius=this.collider.shape.radius,this.renderManager.addRenderData(this.renderData)},e}(R),xe=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.debug=!1,e.position=new s,e}return p(e,t),e.prototype.init=function(t){var e,i;this.tilemapRenderer=t.tilemapRenderer,this.layer=t.layer,this.debug=(null!==(e=t.debug)&&void 0!==e?e:this.debug)&&this.gameConfig.debugEnabled,this.physics=!0,this.composite=null!==(i=t.composite)&&void 0!==i&&i,this.scaledTileWidth=this.tilemapRenderer.tileWidth*this.gameObject.transform.scale.x,this.scaledTileHeight=this.tilemapRenderer.tileHeight*this.gameObject.transform.scale.y,this.scaledWidth=this.tilemapRenderer.width*this.scaledTileWidth,this.scaledHeight=this.tilemapRenderer.height*this.scaledTileHeight,this.position.set(this.gameObject.transform.position.x+(this.tilemapRenderer.orientation===T.Center?-this.scaledWidth/2:0),this.gameObject.transform.position.y+([T.Center,T.RightCenter].includes(this.tilemapRenderer.orientation)?this.scaledHeight/2:this.tilemapRenderer.orientation==T.RightUp?this.scaledHeight:0)),this.composite?this.useLineColliders():this.useBoxColliders(),this.debug&&(this.renderer=this.gameObject.addComponent(be,{colliders:this.colliders}))},e.prototype.useBoxColliders=function(){var t=this;this.tilemapRenderer.tiles.forEach((function(e,i){var o;t.needsCollider(e,i)&&t.colliders.push(t.physicsManager.addCollider({layer:null!==(o=t.layer)&&void 0!==o?o:t.gameObject.layer,position:new s(t.position.x+(i%t.tilemapRenderer.width+.5)*t.scaledTileWidth,t.position.y-(Math.floor(i/t.tilemapRenderer.width)+.5)*t.scaledTileHeight),shape:new Zt(t.scaledTileWidth,t.scaledTileHeight),updateCollisions:!1,physics:t.physics,group:t.gameObject.id.toString()}))}))},e.prototype.needsCollider=function(t,e){var i=this;return 0!==t&&this.getNeighbors(e).some((function(t){return!t||!i.tilemapRenderer.tiles[t]||0===i.tilemapRenderer.tiles[t]}))},e.prototype.useLineColliders=function(){var t,e,i=this,o=[],r=[];this.tilemapRenderer.tiles.forEach((function(t,e){if(0!==t){var s=e%i.tilemapRenderer.width,n=Math.floor(e/i.tilemapRenderer.width);o[n]||(o[n]=[]),o[n+1]||(o[n+1]=[]),r[n]||(r[n]=[]),r[n+1]||(r[n+1]=[]);var a=i.getNeighbors(e);i.hasTile(a[0])||(o[n][s]=!0),i.hasTile(a[2])||(o[n+1][s]=!0),i.hasTile(a[1])||(r[n][s]=!0),i.hasTile(a[3])||(r[n][s+1]=!0)}}));for(var n=0;n<o.length;n++)if(o[n])for(var a=0;a<o[n].length;a++)!t||!e||n===e.y&&o[n][a]||(this.addLineCollider(t,e),t=void 0,e=void 0),o[n][a]&&(t||(t=new s(a,n)),e=new s(a+1,n));for(t&&e&&this.addLineCollider(t,e),t=void 0,e=void 0,a=0;a<=this.tilemapRenderer.width;a++)for(n=0;n<r.length;n++)r[n]&&(!t||!e||a===e.x&&r[n][a]||(this.addLineCollider(t,e),t=void 0,e=void 0),r[n][a]&&(t||(t=new s(a,n)),e=new s(a,n+1)));t&&e&&this.addLineCollider(t,e)},e.prototype.hasTile=function(t){return void 0!==t&&this.tilemapRenderer.tiles[t]&&this.tilemapRenderer.tiles[t]>0},e.prototype.addLineCollider=function(t,e){var i,o=this.physicsManager.addCollider({layer:null!==(i=this.layer)&&void 0!==i?i:this.gameObject.layer,position:this.position.clone(),shape:new Qt([new s(t.x*this.scaledTileWidth,t.y*-this.scaledTileHeight),new s(e.x*this.scaledTileWidth,e.y*-this.scaledTileHeight)]),updateCollisions:!1,physics:this.physics,group:this.gameObject.id.toString()});this.colliders.push(o)},e.prototype.getNeighbors=function(t){return[t-this.tilemapRenderer.width>=0?t-this.tilemapRenderer.width:void 0,t%this.tilemapRenderer.width>0?t-1:void 0,t+this.tilemapRenderer.width<=this.tilemapRenderer.width*this.tilemapRenderer.height?t+this.tilemapRenderer.width:void 0,t%this.tilemapRenderer.width<this.tilemapRenderer.width-1?t+1:void 0]},e.prototype.updateRealSize=function(){},e.prototype.updatePosition=function(){},e.prototype.updateColliders=function(){var t=this;this.colliders.forEach((function(e){var i;return e.layer=null!==(i=t.layer)&&void 0!==i?i:t.gameObject.layer}))},e}(ne),be=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.renderData=[],e.colliders=[],e}return p(e,t),e.prototype.init=function(t){var e=this,i=t.colliders;this.colliders=i,this.colliders.forEach((function(t,i){e.renderData[i]={type:A.Geometric,layer:e.gameObject.layer,location:S.WorldSpace,position:new s,shape:O.Polygon,color:"#00FF00"}}))},e.prototype.update=function(){var t=this;this.colliders.forEach((function(e,i){t.renderData[i].layer=t.gameObject.layer,t.renderData[i].position.copy(e.shape.position),t.renderData[i].rotation=e.rotation,t.renderData[i].vertexModel=e.shape.vertexModel,t.renderManager.addRenderData(t.renderData[i])}))},e}(R),Me=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.debug=!1,e.offsetX=0,e.offsetY=0,e.scaledVertexModel=[],e.scaledOffset=new s,e.scaledPosition=new s,e.finalRotation=0,e.innerPosition=new s,e}return p(e,t),e.prototype.init=function(t){var e,i,o,r,n,a;if(this.gameConfig.collisions.collisionMethod!==Lt.SAT)throw new F("Edge Colliders need SAT collision method.");if(t.vertexModel.length<2)throw new F("Edge Collider needs at least 2 vertices.");this.debug=(null!==(e=t.debug)&&void 0!==e?e:this.debug)&&this.gameConfig.debugEnabled,this.vertexModel=t.vertexModel,this.offsetX=null!==(i=t.offsetX)&&void 0!==i?i:this.offsetX,this.offsetY=null!==(o=t.offsetY)&&void 0!==o?o:this.offsetY,this.physics=null!==(r=t.physics)&&void 0!==r?r:this.physics,this.rotation=null!==(n=t.rotation)&&void 0!==n?n:new d,this.layer=t.layer;for(var h=0;h<this.vertexModel.length;h++)this.scaledVertexModel.push(new s);for(h=0;h<this.scaledVertexModel.length-1;h++)this.colliders.push(this.physicsManager.addCollider({layer:null!==(a=this.layer)&&void 0!==a?a:this.gameObject.layer,position:this.gameObject.transform.position.clone(),rotation:this.rotation.radians,shape:new Qt([this.scaledVertexModel[h],this.scaledVertexModel[h+1]]),updateCollisions:!0,physics:this.physics,group:this.gameObject.id.toString()}));this.debug&&(this.renderer=this.gameObject.addComponent(we,{colliders:this.colliders}))},e.prototype.updateRealSize=function(){var t=this;this.vertexModel.forEach((function(e,i){return t.scaledVertexModel[i].set(e.x*t.gameObject.transform.scale.x,e.y*t.gameObject.transform.scale.y)})),this.scaledOffset.x=this.offsetX*this.gameObject.transform.scale.x,this.scaledOffset.y=this.offsetY*this.gameObject.transform.scale.y,this.finalRotation=this.gameObject.transform.rotation.radians+this.rotation.radians},e.prototype.updatePosition=function(){s.add(this.scaledPosition,this.gameObject.transform.position,this.scaledOffset),0!==this.gameObject.transform.rotation.radians&&this.translate()},e.prototype.translate=function(){s.subtract(this.innerPosition,this.scaledPosition,this.gameObject.transform.position);var t=Math.atan2(this.innerPosition.y,this.innerPosition.x)+this.gameObject.transform.rotation.radians;this.scaledPosition.set(this.gameObject.transform.position.x+this.innerPosition.magnitude*Math.cos(t),this.gameObject.transform.position.y+this.innerPosition.magnitude*Math.sin(t))},e.prototype.updateColliders=function(){for(var t,e=0;e<this.scaledVertexModel.length-1;e++)this.colliders[e].layer=null!==(t=this.layer)&&void 0!==t?t:this.gameObject.layer,this.colliders[e].position.copy(this.scaledPosition),this.colliders[e].rotation=this.finalRotation,this.colliders[e].shape.vertexModel=[this.scaledVertexModel[e],this.scaledVertexModel[e+1]]},e}(ne),we=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.renderData=[],e.colliders=[],e}return p(e,t),e.prototype.init=function(t){var e=this,i=t.colliders;this.colliders=i,this.colliders.forEach((function(t,i){e.renderData[i]={type:A.Geometric,layer:e.gameObject.layer,location:S.WorldSpace,position:new s,shape:O.Line,color:"#00FF00"}}))},e.prototype.update=function(){var t=this;this.colliders.forEach((function(e,i){t.renderData[i].layer=t.gameObject.layer,t.renderData[i].position=e.position,t.renderData[i].rotation=e.rotation,t.renderData[i].vertexModel=e.shape.vertexModel,t.renderManager.addRenderData(t.renderData[i])}))},e}(R),Ce=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spriteDefaultScale=e.gameConfig.spriteDefaultScale,e.renderData=[],e.innerPosition=new s,e.cachePosition=new s,e.cacheRenderPosition=new s,e.scaledOffset=new s,e}return p(e,t),e.prototype.init=function(t){var e,i,o,r,n,a,h;void 0===t&&(t={}),this.sprite=t.sprite,this.offset=null!==(e=t.offset)&&void 0!==e?e:new s,this.rotation=null!==(i=t.rotation)&&void 0!==i?i:new d,this.flipHorizontal=null!==(o=t.flipHorizontal)&&void 0!==o&&o,this.flipVertical=null!==(r=t.flipVertical)&&void 0!==r&&r,this.opacity=null!==(n=t.opacity)&&void 0!==n?n:1,this._tiled=null!==(a=t.tiled)&&void 0!==a?a:new s(1,1),this.maskColor=t.maskColor,this.maskColorMix=null!==(h=t.maskColorMix)&&void 0!==h?h:0,this.tintColor=t.tintColor,this.layer=t.layer},Object.defineProperty(e.prototype,"tiled",{get:function(){return this._tiled},set:function(t){if(t.x%1!=0||t.y%1!=0)throw new F("SpriteRenderer.tiled: Vector2 components must be integers");this._tiled.set(t.x,t.y)},enumerable:!1,configurable:!0}),e.prototype.update=function(){var t;if(this.sprite&&!0===this.sprite.loaded){this.sprite.scale=null!==(t=this.sprite.scale)&&void 0!==t?t:this.spriteDefaultScale,this.updateRenderDataArray();for(var e=0,i=0;i<this._tiled.x;i++)for(var s=0;s<this._tiled.y;s++)this.updateRenderData(e,i,s),e++}},e.prototype.updateRenderDataArray=function(){if(this.renderData.length!==this._tiled.x*this._tiled.y){this.renderData=[];for(var t=0;t<this._tiled.x*this._tiled.y;t++)this.renderData[t]={type:A.Sprite,location:S.WorldSpace,layer:"",position:new s,image:this.sprite.image,width:0,height:0}}},e.prototype.updateRenderData=function(t,e,i){var s;this.renderData[t].location=this.gameObject.ui?S.ViewPort:S.WorldSpace,this.renderData[t].layer=null!==(s=this.layer)&&void 0!==s?s:this.gameObject.layer,this.renderData[t].image=this.sprite.image,this.renderData[t].width=this.sprite.width*Math.abs(this.gameObject.transform.scale.x),this.renderData[t].height=this.sprite.height*Math.abs(this.gameObject.transform.scale.y),this.renderData[t].slice=this.sprite.slice,this.renderData[t].flipHorizontal=this.flipHorizontal!==this.gameObject.transform.scale.x<0,this.renderData[t].flipVertical=this.flipVertical!==this.gameObject.transform.scale.y<0,this.renderData[t].rotation=this.gameObject.transform.rotation.radians+this.rotation.radians,this.renderData[t].smooth=this.sprite.smooth,this.renderData[t].alpha=this.opacity,this.renderData[t].maskColor=this.maskColor,this.renderData[t].maskColorMix=this.maskColorMix,this.renderData[t].tintColor=this.tintColor,this.calculateRenderPosition(t,e,i),this.renderManager.addRenderData(this.renderData[t])},e.prototype.calculateRenderPosition=function(t,e,i){this.scaledOffset.set(this.offset.x*this.gameObject.transform.scale.x,this.offset.y*this.gameObject.transform.scale.y),s.add(this.cachePosition,this.gameObject.transform.position,this.scaledOffset),this.cacheRenderPosition.set(this.renderData[t].width/2*(this._tiled.x-1),this.renderData[t].height/2*(this._tiled.y-1)),s.subtract(this.cachePosition,this.cachePosition,this.cacheRenderPosition),this.cacheRenderPosition.set(e*this.renderData[t].width,i*this.renderData[t].height),s.add(this.renderData[t].position,this.cachePosition,this.cacheRenderPosition),0!==this.gameObject.transform.rotation.radians&&this.translateRenderPosition(t)},e.prototype.translateRenderPosition=function(t){s.subtract(this.innerPosition,this.renderData[t].position,this.gameObject.transform.position);var e=Math.atan2(this.innerPosition.y,this.innerPosition.x)+this.gameObject.transform.rotation.radians;this.renderData[t].position.set(this.gameObject.transform.position.x+this.innerPosition.magnitude*Math.cos(e),this.gameObject.transform.position.y+this.innerPosition.magnitude*Math.sin(e))},e}(R),_e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lastFrameText="",e}return p(e,t),e.prototype.init=function(t){var e,i,o,r,n,a,h,l,c,u,p,g;if(this.text=t.text,this.font=null!==(e=t.font)&&void 0!==e?e:"Sans",this.fontSize=null!==(i=t.fontSize)&&void 0!==i?i:12,this.width=null!==(o=t.width)&&void 0!==o?o:100,this.height=null!==(r=t.height)&&void 0!==r?r:100,this.offset=null!==(n=t.offset)&&void 0!==n?n:new s,this.color=null!==(a=t.color)&&void 0!==a?a:"#000000",this.charRanges=null!==(h=t.charRanges)&&void 0!==h?h:[32,126,161,255],this.lineSeparation=null!==(l=t.lineSeparation)&&void 0!==l?l:0,this.letterSpacing=null!==(c=t.letterSpacing)&&void 0!==c?c:0,this.smooth=null!==(u=t.smooth)&&void 0!==u&&u,this.rotation=null!==(p=t.rotation)&&void 0!==p?p:new d,this.opacity=null!==(g=t.opacity)&&void 0!==g?g:1,this.orientation=t.orientation,this.bitmapMargin=t.bitmapMargin,this.bitmapSpacing=t.bitmapSpacing,this.charRanges.length%2!=0)throw new F("TextRenderer.charRanges must be a 2 column matrix");if(this.lineSeparation%2!=0)throw new F("TextRenderer.lineSeparation must be multiple of 2")},e.prototype.start=function(){this.renderData={type:A.Text,location:S.WorldSpace,position:new s,layer:this.gameObject.layer,text:"",font:this.font,fontSize:this.fontSize,bitmap:{charRanges:this.charRanges,margin:this.bitmapMargin,spacing:this.bitmapSpacing},smooth:this.smooth}},e.prototype.update=function(){var t,e;this.text&&(this.renderData.layer=this.gameObject.layer,this.renderData.location=this.gameObject.ui?S.ViewPort:S.WorldSpace,this.renderData.text=this.text!==this.lastFrameText?this.crop():this.renderData.text,this.renderData.fontSize=this.fontSize,this.renderData.color=this.color,this.renderData.orientation=this.orientation,this.renderData.lineSeparation=this.lineSeparation,this.renderData.letterSpacing=this.letterSpacing,this.renderData.rotation=null!==(e=this.gameObject.transform.rotation.radians+(null===(t=this.rotation)||void 0===t?void 0:t.radians))&&void 0!==e?e:0,this.renderData.alpha=this.opacity,s.add(this.renderData.position,this.gameObject.transform.position,this.offset),this.renderManager.addRenderData(this.renderData),this.lastFrameText=this.text)},e.prototype.crop=function(){var t;if(this.fontSize>this.height)return"";for(var e=[],i=0,s=0,o=this.text.split("\n");s<o.length;s++)for(var r=0,n=null!==(t=o[s].match(new RegExp(".{1,"+Math.floor(this.width/(this.fontSize+this.letterSpacing))+"}","g")))&&void 0!==t?t:[""];r<n.length;r++){var a=n[r];if((i+=this.fontSize+this.lineSeparation)>this.height)return e.join("\n");e.push(a)}return e.join("\n")},e}(R),je=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.offset=new s,e.rotation=new d,e.opacity=1,e.innerPosition=new s,e.scaledOffset=new s,e}return p(e,t),e.prototype.init=function(t){var e,i,o,r;this.width=t.width,this.height=t.height,this.color=t.color,this.offset=null!==(e=t.offset)&&void 0!==e?e:this.offset,this.rotation=null!==(i=t.rotation)&&void 0!==i?i:this.rotation,this.opacity=null!==(o=t.opacity)&&void 0!==o?o:this.opacity,this.layer=t.layer,this.renderData={type:A.Mask,layer:null!==(r=this.layer)&&void 0!==r?r:this.gameObject.layer,location:this.gameObject.ui?S.ViewPort:S.WorldSpace,position:new s,width:0,height:0,color:""}},e.prototype.update=function(){var t;this.renderData.location=this.gameObject.ui?S.ViewPort:S.WorldSpace,this.renderData.layer=null!==(t=this.layer)&&void 0!==t?t:this.gameObject.layer,this.renderData.width=this.width*Math.abs(this.gameObject.transform.scale.x),this.renderData.height=this.height*Math.abs(this.gameObject.transform.scale.y),this.renderData.color=this.color,this.renderData.rotation=this.gameObject.transform.rotation.radians+this.rotation.radians,this.renderData.alpha=this.opacity,this.calculateRenderPosition(),this.renderManager.addRenderData(this.renderData)},e.prototype.calculateRenderPosition=function(){this.scaledOffset.set(this.offset.x*this.gameObject.transform.scale.x,this.offset.y*this.gameObject.transform.scale.y),s.add(this.renderData.position,this.gameObject.transform.position,this.scaledOffset),0!==this.gameObject.transform.rotation.radians&&this.translateRenderPosition()},e.prototype.translateRenderPosition=function(){s.subtract(this.innerPosition,this.renderData.position,this.gameObject.transform.position);var t=Math.atan2(this.innerPosition.y,this.innerPosition.x)+this.gameObject.transform.rotation.radians;this.renderData.position.set(this.gameObject.transform.position.x+this.innerPosition.magnitude*Math.cos(t),this.gameObject.transform.position.y+this.innerPosition.magnitude*Math.sin(t))},e}(R),Pe=["click","contextmenu","auxclick","dblclick","mousedown","mouseup","pointerup","touchend","keydown","keyup"],Re=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.innerPosition=new s,e.scaledOffset=new s,e._playing=!1,e._paused=!1,e.videoEventHandler=function(t){"ended"===t.type&&(e._playing=!1,e.video.removeEventListener("ended",e.videoEventHandler))},e.userInputEventHandler=function(){Pe.forEach((function(t){window.removeEventListener(t,e.userInputEventHandler)})),e.video&&e._playing&&e.video.play()},e}return p(e,t),Object.defineProperty(e.prototype,"volume",{get:function(){return this._volume},set:function(t){this._volume=t,this.video&&(this.video.volume=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=t,this.video&&(this.video.loop=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playing",{get:function(){return this._playing},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paused",{get:function(){return this._paused},enumerable:!1,configurable:!0}),e.prototype.init=function(t){var e,i,o,r,n,a,h,l,c,u;this.video=t.video,this.width=null!==(e=t.width)&&void 0!==e?e:this.video.videoWidth,this.height=null!==(i=t.height)&&void 0!==i?i:this.video.videoHeight,this.offset=null!==(o=t.offset)&&void 0!==o?o:new s,this.rotation=null!==(r=t.rotation)&&void 0!==r?r:new d,this.flipHorizontal=null!==(n=t.flipHorizontal)&&void 0!==n&&n,this.flipVertical=null!==(a=t.flipVertical)&&void 0!==a&&a,this.opacity=null!==(h=t.opacity)&&void 0!==h?h:1,this.maskColor=t.maskColor,this.maskColorMix=null!==(l=t.maskColorMix)&&void 0!==l?l:0,this.tintColor=t.tintColor,this.layer=t.layer,this.slice=t.slice,this._volume=null!==(c=t.volume)&&void 0!==c?c:1,this._loop=null!==(u=t.loop)&&void 0!==u&&u,this.renderData={type:A.Video,location:S.WorldSpace,layer:"",position:new s,video:this.video,width:this.width,height:this.height}},e.prototype.play=function(){var t=this;if((this.video||!this.video.duration)&&(!this._playing||!1!==this._paused)){if(this._paused)return this._paused=!1,void this.video.play();this.video.loop=this._loop,this.video.volume=this._volume,this.video.addEventListener("ended",this.videoEventHandler),this._playing=!0;var e=this.video.play();void 0!==e&&e.catch((function(){Pe.forEach((function(e){return window.addEventListener(e,t.userInputEventHandler)}))}))}},e.prototype.stop=function(){this._playing&&(this.video.pause(),this.video.currentTime=0,this.video.removeEventListener("ended",this.videoEventHandler),this._playing=!1,this._paused=!1)},e.prototype.pause=function(){this._playing&&!1===this._paused&&(this.video.pause(),this._paused=!0)},e.prototype.update=function(){var t;this.video&&this.video.duration&&(this.renderData.location=this.gameObject.ui?S.ViewPort:S.WorldSpace,this.renderData.layer=null!==(t=this.layer)&&void 0!==t?t:this.gameObject.layer,this.renderData.video=this.video,this.renderData.width=this.width*Math.abs(this.gameObject.transform.scale.x),this.renderData.height=this.height*Math.abs(this.gameObject.transform.scale.y),this.renderData.slice=this.slice,this.renderData.flipHorizontal=this.flipHorizontal!==this.gameObject.transform.scale.x<0,this.renderData.flipVertical=this.flipVertical!==this.gameObject.transform.scale.y<0,this.renderData.rotation=this.gameObject.transform.rotation.radians+this.rotation.radians,this.renderData.alpha=this.opacity,this.renderData.maskColor=this.maskColor,this.renderData.maskColorMix=this.maskColorMix,this.renderData.tintColor=this.tintColor,this.calculateRenderPosition(),this.renderManager.addRenderData(this.renderData))},e.prototype.calculateRenderPosition=function(){this.scaledOffset.set(this.offset.x*this.gameObject.transform.scale.x,this.offset.y*this.gameObject.transform.scale.y),s.add(this.renderData.position,this.gameObject.transform.position,this.scaledOffset),0!==this.gameObject.transform.rotation.radians&&this.translateRenderPosition()},e.prototype.translateRenderPosition=function(){s.subtract(this.innerPosition,this.renderData.position,this.gameObject.transform.position);var t=Math.atan2(this.innerPosition.y,this.innerPosition.x)+this.gameObject.transform.rotation.radians;this.renderData.position.set(this.gameObject.transform.position.x+this.innerPosition.magnitude*Math.cos(t),this.gameObject.transform.position.y+this.innerPosition.magnitude*Math.sin(t))},e.prototype.onActiveChange=function(){!1===this.active&&this.stop()},e.prototype.onDestroy=function(){this.stop()},e}(R),Oe=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tiles=[],e.tilesetTileIds=[],e.chunks=[],e.scaledTileWidth=0,e.scaledTileHeight=0,e.renderData=[],e}return p(e,t),e.prototype.init=function(t){var e=t.tiledData,i=t.tilemapLayer,s=t.tileset,o=t.tileWidth,r=t.tileHeight,n=t.layer,a=t.orientation,h=t.smooth;this.tiledData=e,this.tilemapLayer=i,this.tileset=s,this.tileWidth=o,this.tileHeight=r,this.layer=n,this.smooth=null!=h&&h,this.width=this.tiledData.width,this.height=this.tiledData.height,this.orientation=a,this.processTilemap()},e.prototype.update=function(){var t=this;this.updateRenderData(),this.renderData.forEach((function(e){return t.renderManager.addRenderData(e)}))},e.prototype.processTilemap=function(){var t=this;this.tiledData.layers.forEach((function(e){!0===e.visible&&t.tilemapLayer===e.name&&(t.alpha=e.opacity,t.tintColor=e.tintcolor,!0===t.tiledData.infinite?e.chunks.forEach((function(e){return t.processChunk(e)})):t.processChunk(e))})),this.updateRenderData(),this.tilesetTileIds=[]},e.prototype.processChunk=function(t){var e,i=this,o={type:A.Tilemap,layer:null!==(e=this.layer)&&void 0!==e?e:this.gameObject.layer,location:this.gameObject.ui?S.ViewPort:S.WorldSpace,position:new s,tileset:this.tileset,tilemap:{width:t.width,tileWidth:this.tileWidth,tileHeight:this.tileHeight},tiles:t.data.map((function(t){return i.getTilesetTileId(t)})),orientation:this.orientation,smooth:this.smooth};t.type&&"tilelayer"===t.type?this.tiles=o.tiles:o.tiles.forEach((function(e,s){i.tiles[i.tiledData.width*(t.y+Math.floor(s/t.width))+t.x+s%t.width]=e})),this.renderData.push(o),this.chunks.push(t)},e.prototype.getTilesetTileId=function(t){return this.tilesetTileIds[t]||(this.tilesetTileIds[t]=this.tiledData.tilesets.reduce((function(e,i){return t>=i.firstgid?t-i.firstgid+1:e}),0)),this.tilesetTileIds[t]},e.prototype.updateRenderData=function(){var t=this;this.scaledTileWidth=this.tileWidth*this.gameObject.transform.scale.x,this.scaledTileHeight=this.tileHeight*this.gameObject.transform.scale.y,this.realWidth=this.tiledData.width*this.scaledTileWidth,this.realHeight=this.tiledData.height*this.scaledTileHeight,this.renderData.forEach((function(e,i){var s;e.layer=null!==(s=t.layer)&&void 0!==s?s:t.gameObject.layer,e.position.set(t.gameObject.transform.position.x+t.chunks[i].x*t.scaledTileWidth,t.gameObject.transform.position.y+t.chunks[i].y*t.scaledTileHeight),e.tilemap.tileWidth=t.scaledTileWidth,e.tilemap.tileHeight=t.scaledTileHeight,e.tintColor=t.tintColor,e.alpha=t.alpha}))},e}(R),Se=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tiles=[],e.scaledTileWidth=0,e.scaledTileHeight=0,e}return p(e,t),e.prototype.init=function(t){var e,i=this,o=t.tiles,r=t.tileset,n=t.tileWidth,a=t.tileHeight,h=t.width,l=t.layer,c=t.orientation,d=t.alpha,u=t.tintColor,p=t.smooth;o.split("\n").forEach((function(t){t.split(",").forEach((function(t){return t.trim().length>0?i.tiles.push(Number(t)):null}))})),this.tileset=r,this.width=h,this.tileWidth=n,this.tileHeight=a,this.layer=l,this.height=Math.ceil(this.tiles.length/this.width),this.orientation=c,this.alpha=d,this.tintColor=u,this.renderData={type:A.Tilemap,layer:null!==(e=this.layer)&&void 0!==e?e:this.gameObject.layer,location:this.gameObject.ui?S.ViewPort:S.WorldSpace,position:new s,tileset:this.tileset,tilemap:{width:this.width,tileWidth:this.tileWidth,tileHeight:this.tileHeight},tiles:this.tiles,orientation:this.orientation,smooth:p},this.updateRenderData()},e.prototype.update=function(){this.updateRenderData(),this.renderManager.addRenderData(this.renderData)},e.prototype.updateRenderData=function(){var t;this.scaledTileWidth=this.tileWidth*this.gameObject.transform.scale.x,this.scaledTileHeight=this.tileHeight*this.gameObject.transform.scale.y,this.realWidth=this.width*this.scaledTileWidth,this.realHeight=this.height*this.scaledTileHeight,this.renderData.layer=null!==(t=this.layer)&&void 0!==t?t:this.gameObject.layer,this.renderData.position.copy(this.gameObject.transform.position),this.renderData.tintColor=this.tintColor,this.renderData.alpha=this.alpha,this.renderData.tilemap.tileWidth=this.scaledTileWidth,this.renderData.tilemap.tileHeight=this.scaledTileHeight},e}(R),Ae=function(t){var e,i;this.sprites=[],this.framerate=10,this.loop=!1,this.sprites=t.sprites,this.framerate=null!==(e=t.framerate)&&void 0!==e?e:this.framerate,this.loop=null!==(i=t.loop)&&void 0!==i?i:this.loop},Te=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.spriteRenderer=null,e.animations=new Map,e.currentAnimation=null,e.paused=!1,e}return p(e,t),e.prototype.init=function(t){var e=t.spriteRenderer;this.spriteRenderer=e},e.prototype.update=function(){null===this.currentAnimation||this.paused||(this.currentAnimation.playFrame(this.timeManager.deltaTime),!0===this.currentAnimation.restarted&&!1===this.currentAnimation.loop?this.currentAnimation=null:this.spriteRenderer.sprite=this.currentAnimation.sprite)},e.prototype.addAnimation=function(t,e,i){return void 0===e&&(e="default"),t.framerate=null!=i?i:t.framerate,this.animations.set(e,new Ee(t)),this},e.prototype.playAnimation=function(t){if(void 0===t&&(t="default"),!1!==this.active){if(!1===this.animations.has(t))throw new F("Animation with name ".concat(t," does not exist."));this.stopAnimation(),this.currentAnimation=this.animations.get(t)}},e.prototype.pause=function(){this.paused=!0},e.prototype.resume=function(){this.paused=!1},e.prototype.stopAnimation=function(){null!==this.currentAnimation&&(this.currentAnimation.reset(),this.currentAnimation=null)},e.prototype.isPlayingAnimation=function(t){return void 0===t&&(t="default"),null!==this.currentAnimation&&this.animations.get(t)&&this.animations.get(t)===this.currentAnimation},e.prototype.isPaused=function(){return this.paused},e}(M),Ee=function(){function t(t){this._sprite=null,this._restarted=!1,this.currentFrame=0,this.frameTime=0,this._animation=t}return Object.defineProperty(t.prototype,"sprite",{get:function(){return this._sprite},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"restarted",{get:function(){return this._restarted},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"loop",{get:function(){return this._animation.loop},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"animation",{get:function(){return this._animation},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.currentFrame=0,this.frameTime=0,this._restarted=!0},t.prototype.playFrame=function(t){this._restarted=!1,this.frameTime>=1/this._animation.framerate&&(this.frameTime=0,this.currentFrame=this.currentFrame+1===this._animation.sprites.length?0:this.currentFrame+1,this._restarted=0===this.currentFrame),this._sprite=this._animation.sprites[this.currentFrame],this.frameTime+=t},t}(),De=["click","contextmenu","auxclick","dblclick","mousedown","mouseup","pointerup","touchend","keydown","keyup"],Fe=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.allowMultiple=!1,e.tracks=[],e.audioSourceCache=new Map,e._playing=!1,e._paused=!1,e.audioEventHandler=function(t){"ended"===t.type&&(e._playing=!1,e._audioSource.removeEventListener("ended",e.audioEventHandler))},e.userInputEventHandler=function(){De.forEach((function(t){window.removeEventListener(t,e.userInputEventHandler)})),e.audioContext.resume(),e._audioSource&&e._playing&&e._audioSource.play()},e}return p(e,t),Object.defineProperty(e.prototype,"audioSource",{get:function(){return this._audioSource},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"volume",{get:function(){return this._volume},set:function(t){this._volume=t,this._audioSource&&(this._audioSource.volume=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=t,this._audioSource&&(this._audioSource.loop=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playing",{get:function(){return this._playing},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paused",{get:function(){return this._paused},enumerable:!1,configurable:!0}),e.prototype.init=function(t){var e=this,i=void 0===t?{}:t,s=i.loop,o=i.volume;this.audioContext=new AudioContext,"running"!==this.audioContext.state&&De.forEach((function(t){return window.addEventListener(t,e.userInputEventHandler)})),this._volume=null!=o?o:1,this._loop=null!=s&&s},e.prototype.playClip=function(t,e){t.currentTime>0&&(t.currentTime=0),t.volume=null!=e?e:this._volume,t.play()},e.prototype.addAudioSource=function(t,e){void 0===e&&(e="default");var i=t.cloneNode();this.audioSourceCache.set(e,i);var s=this.audioContext.createMediaElementSource(i);s.connect(this.audioContext.destination),this.tracks.push(s)},e.prototype.loadAudioSource=function(t,e,i){this.stop(),this._audioSource=this.audioSourceCache.get(t),this._loop=null!=e?e:this._loop,this._volume=null!=i?i:this._volume},e.prototype.play=function(){if(this._audioSource&&(!this._playing||!1!==this._paused)){if(this._paused)return this._paused=!1,void this._audioSource.play();this._audioSource.volume=this._volume,this._audioSource.loop=this._loop,this._audioSource.addEventListener("ended",this.audioEventHandler),this._playing=!0,"running"===this.audioContext.state&&this._audioSource.play()}},e.prototype.stop=function(){this._playing&&(this._audioSource.pause(),this._audioSource.currentTime=0,this._audioSource.removeEventListener("ended",this.audioEventHandler),this._playing=!1,this._paused=!1)},e.prototype.pause=function(){this._playing&&!1===this._paused&&(this._audioSource.pause(),this._paused=!0)},e.prototype.onActiveChange=function(){!1===this.active&&this.stop()},e.prototype.onDestroy=function(){this.stop(),this.audioContext.close()},e}(M),Be=function(){function t(t){var e,i=this;this._width=null,this._height=null,this._loaded=!1,this.image=t.image,this.smooth=null!==(e=t.smooth)&&void 0!==e&&e,this.slice=t.slice,this.scale=t.scale,this.slice&&(this._width=this.slice.width,this._height=this.slice.height);var s=function(){var t,e;i._width=null!==(t=i._width)&&void 0!==t?t:i.image.naturalWidth,i._height=null!==(e=i._height)&&void 0!==e?e:i.image.naturalHeight,i._loaded=!0};this.image.naturalWidth?s():this.image.addEventListener("load",(function(){return s()}))}return Object.defineProperty(t.prototype,"width",{get:function(){var t,e;return null!==(e=this._width*(null===(t=this.scale)||void 0===t?void 0:t.x))&&void 0!==e?e:1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){var t,e;return null!==(e=this._height*(null===(t=this.scale)||void 0===t?void 0:t.y))&&void 0!==e?e:1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"loaded",{get:function(){return this._loaded},enumerable:!1,configurable:!0}),t}();!function(t){t[t.Rectangle=0]="Rectangle",t[t.Circumference=1]="Circumference"}(te||(te={}));var Ie=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.allowMultiple=!1,e.width=100,e.height=100,e.radius=50,e.touchEnabled=!0,e._offset=new s,e.pressed=!1,e.mouse=e.inputManager.mouse,e.touch=e.inputManager.touch,e.position=new s,e.distance=new s,e.pressedLastFrame=!1,e.scaled={width:0,height:0,radius:0,offset:new s},e}return p(e,t),Object.defineProperty(e.prototype,"offset",{get:function(){return this._offset},set:function(t){this._offset=t},enumerable:!1,configurable:!0}),e.prototype.init=function(t){var e=t.type,i=t.height,s=t.radius,o=t.touchEnabled,r=t.width,n=t.offset;this.type=e,this.width=null!=r?r:this.width,this.height=null!=i?i:this.height,this.radius=null!=s?s:this.radius,this.touchEnabled=null!=o?o:this.touchEnabled,this._offset=null!=n?n:this._offset},e.prototype.update=function(){this.scale(),s.add(this.position,this.gameObject.transform.position,this.scaled.offset),this.pressedLastFrame=this.pressed,this.pressed=!1,this.mouse.leftButtonPressed&&(this.resolveMouseAndRectangle(),this.resolveMouseAndCircumference()),this.touchEnabled&&this.touch.touching&&(this.resolveTouchAndRectangle(),this.resolveTouchAndCircumference()),this.onClick&&!this.pressedLastFrame&&this.pressed&&this.onClick(),this.onPressed&&this.pressed&&this.onPressed()},e.prototype.scale=function(){this.scaled.width=this.width*this.gameObject.transform.scale.x,this.scaled.height=this.width*this.gameObject.transform.scale.y,this.scaled.offset.x=this._offset.x*this.gameObject.transform.scale.x,this.scaled.offset.y=this._offset.y*this.gameObject.transform.scale.y,this.scaled.radius=this.radius*Math.max(Math.abs(this.gameObject.transform.scale.x),Math.abs(this.gameObject.transform.scale.y))},e.prototype.resolveMouseAndRectangle=function(){this.type===te.Rectangle&&(this.pressed||(this.pressed=c(this.mouse.positionInViewport.x,this.position.x-this.scaled.width/2,this.position.x+this.scaled.width/2)&&c(this.mouse.positionInViewport.y,this.position.y-this.scaled.height/2,this.position.y+this.scaled.height/2)))},e.prototype.resolveMouseAndCircumference=function(){this.type===te.Circumference&&(s.subtract(this.distance,this.position,this.mouse.positionInViewport),this.pressed||(this.pressed=this.distance.magnitude<=this.scaled.radius))},e.prototype.resolveTouchAndRectangle=function(){this.type===te.Rectangle&&(this.pressed||(this.pressed=this.position.x+this.scaled.width/2>=this.touch.positionInViewport.x-this.touch.radius.x&&this.position.x-this.scaled.width/2<=this.touch.positionInViewport.x+this.touch.radius.x&&this.position.y+this.scaled.height/2>=this.touch.positionInViewport.y-this.touch.radius.y&&this.position.y-this.scaled.height/2<=this.touch.positionInViewport.y+this.touch.radius.y))},e.prototype.resolveTouchAndCircumference=function(){this.type===te.Circumference&&(s.subtract(this.distance,this.position,this.touch.positionInViewport),this.pressed||(this.pressed=this.distance.magnitude<=this.scaled.radius+this.touch.radius.x))},e}(b),Le=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mousePressed=!1,e.position=new s,e}return p(e,t),e.prototype.start=function(){this.camera=this.getCurrentScene().gameCamera},e.prototype.update=function(){this.inputManager.mouse.leftButtonPressed&&!1===this.mousePressed&&(s.round(this.position,s.add(this.position,this.camera.transform.position,s.scale(this.position,this.inputManager.mouse.positionInViewport,1/this.camera.zoom))),console.log("Space position: {x: ".concat(this.position.x,", y: ").concat(this.position.y,"}"))),this.mousePressed=this.inputManager.mouse.leftButtonPressed},e}(le)},860:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GoblinWalking=void 0;const s=i(844);e.GoblinWalking=t=>new s.Animation({sprites:[0,16,32,48,64,80].map((e=>new s.Sprite({image:t.getImage("image/enemy/goblin_spritesheet.png"),smooth:!1,slice:new s.Rectangle(e,0,16,16)}))),framerate:10,loop:!0})},926:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NinjaRun=e.NinjaIdle=void 0;const s=i(844);e.NinjaIdle=t=>new s.Animation({sprites:[0,16,32,48].map((e=>new s.Sprite({image:t.getImage("image/player/player-spritesheet.png"),smooth:!1,slice:new s.Rectangle(e,64,16,16)}))),framerate:10,loop:!0});e.NinjaRun=t=>new s.Animation({sprites:[0,16,32,48,64,80].map((e=>new s.Sprite({image:t.getImage("image/player/player-spritesheet.png"),smooth:!1,slice:new s.Rectangle(e,16,16,16)}))),framerate:10,loop:!0})},214:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.FollowPlayerCamera=void 0;const s=i(844),o=i(833),r=i(265);class n extends s.PreRenderComponent{constructor(){super(...arguments),this.boundaries={minX:0,maxX:0,minY:0,maxY:0},this.playerOffset=new s.Vector2,this.cachePosition=new s.Vector2}start(){this.player=this.findGameObject(r.Player),this.camera=this.gameObject;const t=this.findGameObject(o.Foreground),e=t.getComponent(s.TiledTilemapRenderer);this.boundaries.minX=t.transform.position.x,this.boundaries.maxX=t.transform.position.x+e.realWidth,this.boundaries.maxY=t.transform.position.y,this.boundaries.minY=t.transform.position.y-e.realHeight,this.cachePosition.copy(this.player.transform.position),this.gameObject.transform.position.copy(this.player.transform.position)}update(){this.followPlayer(),this.clampToBoundaries()}followPlayer(){s.Vector2.subtract(this.playerOffset,this.player.transform.position,this.gameObject.transform.position),this.cachePosition.x=this.player.transform.position.x-(0,s.clamp)(this.playerOffset.x,-80,80),this.cachePosition.y=this.player.transform.position.y-(0,s.clamp)(this.playerOffset.y,-80,80),this.gameObject.transform.position=this.cachePosition}clampToBoundaries(){this.gameObject.transform.position.x=(0,s.clamp)(this.cachePosition.x,this.boundaries.minX+this.camera.viewportRect.width/2,this.boundaries.maxX-this.camera.viewportRect.width/2),this.gameObject.transform.position.y=(0,s.clamp)(this.cachePosition.y,this.boundaries.minY+this.camera.viewportRect.height/2,this.boundaries.maxY-this.camera.viewportRect.height/2)}}e.FollowPlayerCamera=n},960:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AnimationController=void 0;const s=i(844),o=i(51);class r extends s.Component{start(){this.rigidBody=this.getComponent(s.RigidBody),this.animator=this.getComponent(s.Animator),this.movements=this.getComponent(o.Movements)}update(){this.gameObject.transform.scale.x=0!==this.rigidBody.velocity.x?Math.sign(this.rigidBody.velocity.x)*Math.abs(this.gameObject.transform.scale.x):this.gameObject.transform.scale.x,0!==this.rigidBody.velocity.x&&this.movements.grounded?!this.animator.isPlayingAnimation("PlayerRun")&&this.animator.playAnimation("PlayerRun"):!this.animator.isPlayingAnimation("PlayerIdle")&&this.animator.playAnimation("PlayerIdle")}}e.AnimationController=r},51:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Movements=void 0;const s=i(844),o=i(5),r=i(766);class n extends s.Component{constructor(){super(...arguments),this.gravity=3e3,this.walkSpeed=320,this.jumpSpeed=840,this.grounded=!1,this.velocity=new s.Vector2(0,0),this.jumping=!1,this.platformCollision=null,this.hillsCollision=null,this.onMovingPlatform=!1}init(){this.bodyCollider=this.getComponent("BodyCollider"),this.feetCollider=this.getComponent("FeetCollider"),this.headCollider=this.getComponent("HeadCollider"),this.rigidBody=this.getComponent(s.RigidBody)}start(){this.inputController=this.findGameObject(r.InputController),this.rigidBody.gravity=this.gravity,this.gameObject.transform.parentScale=!1}update(){this.platformCollision=this.feetCollider.getCollisionWithLayer(o.LAYERS.Platform),this.grounded=this.feetCollider.collidesWithLayer(o.LAYERS.Foreground)||this.feetCollider.collidesWithLayer(o.LAYERS.Hills)||this.feetCollider.collidesWithLayer(o.LAYERS.Goblin)||null!==this.platformCollision,this.hillsCollision=this.bodyCollider.getCollisionWithLayer(o.LAYERS.Hills),this.checkForMovingPlatform(),this.walk(),this.jump(),this.headCollider.collidesWithLayer(o.LAYERS.Foreground)||(this.bodyCollider.height=this.inputController.axis.y<0?8:16,this.bodyCollider.offsetY=this.inputController.axis.y<0?-4:0,this.headCollider.offsetY=this.inputController.axis.y<0?-2:6)}walk(){this.velocity.set(this.inputController.axis.x*this.walkSpeed*(this.hillsCollision?2:1),this.rigidBody.velocity.y),this.rigidBody.velocity=this.velocity}jump(){!0===this.grounded&&!0===this.inputController.jump&&!1===this.jumping&&(this.jumping=!0,this.velocity.set(this.rigidBody.velocity.x,this.jumpSpeed),this.rigidBody.velocity=this.velocity),this.jumping&&(this.jumping=this.inputController.jump)}checkForMovingPlatform(){this.platformCollision&&!this.onMovingPlatform?(this.gameObject.parent=this.platformCollision.gameObject,this.onMovingPlatform=!0):!this.platformCollision&&this.onMovingPlatform&&(this.gameObject.parent=null,this.onMovingPlatform=!1)}}e.Movements=n},904:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ASSETS=void 0,e.ASSETS={fonts:{main:{name:"PressStart2P-Regular",url:"font/PressStart2P-Regular.ttf"}},images:{tileset:"image/tileset/tileset.png",player:"image/player/player-spritesheet.png",goblin:"image/enemy/goblin_spritesheet.png",woodenPlate:"image/misc/wooden_plate.png",background:"image/scene/background.png"},video:{},audio:{}}},5:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TAGS=e.LAYERS=void 0,e.LAYERS={Player:"Player",Goblin:"Goblin",Background:"Background",Foreground:"Foreground",Platform:"Platform",Hills:"Hills",Overlayer:"Overlayer",Parallax:"Parallax",UI:"UI",Text:"Text"},e.TAGS={}},920:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PARAMETERS=void 0;const s=i(5);e.PARAMETERS={collisionMatrix:[[s.LAYERS.Player,s.LAYERS.Foreground],[s.LAYERS.Player,s.LAYERS.Goblin],[s.LAYERS.Player,s.LAYERS.Platform],[s.LAYERS.Player,s.LAYERS.Hills],[s.LAYERS.Goblin,s.LAYERS.Foreground],[s.LAYERS.Goblin,s.LAYERS.Player],[s.LAYERS.Goblin,s.LAYERS.Platform],[s.LAYERS.Goblin,s.LAYERS.Hills]]}},122:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GameController=void 0;const s=i(844),o=i(130),r=i(766),n=i(265),a=i(365),h=new Proxy(new URLSearchParams(window.location.search),{get:(t,e)=>t.get(e.toString())});class l extends s.GameObject{constructor(){super(...arguments),this.paused=!1,this.pauseKeyReleased=!1}init(){var t;this.pauseText=this.addGameObject(o.Pause),this.pauseText.active=!1,this.player=this.addGameObject(n.Player),this.player.transform.position.set((0,s.randomInt)(240,2720),-600);const e=Number(null!==(t=h.goblins)&&void 0!==t?t:10);for(let t=1;t<=e;t++)this.addGameObject(a.Goblin,{position:new s.Vector2((0,s.randomInt)(240,2720),-400),walkSpeed:(0,s.randomInt)(160,340)/100*60})}start(){this.inputController=this.findGameObject(r.InputController)}update(){this.pause()}pause(){this.pauseKeyReleased&&this.inputController.pause&&(this.paused=!this.paused,this.timeManager.timeScale=this.paused?0:1,this.pauseText.active=this.paused,this.player.active=!this.paused),this.pauseKeyReleased=!this.inputController.pause}}e.GameController=l},365:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Goblin=void 0;const s=i(844),o=i(860),r=i(5);class n extends s.GameObject{constructor(){super(...arguments),this.walkSpeed=96,this.jumpSpeed=840,this.jumping=!0,this.cacheVelocity=new s.Vector2,this.bodyCollision=!1,this.edgeCollision=!1,this.wallCollision=!1,this.playerCollision=!1}init({position:t,walkSpeed:e}){this.layer=r.LAYERS.Goblin,this.spriteRenderer=this.addComponent(s.SpriteRenderer,{sprite:new s.Sprite({image:this.assetManager.getImage("image/enemy/goblin_spritesheet.png"),slice:new s.Rectangle(0,0,16,16),smooth:!1})}),this.animator=this.addComponent(s.Animator,{spriteRenderer:this.spriteRenderer}).addAnimation((0,o.GoblinWalking)(this.assetManager),"Walking"),this.bodyCollider=this.addComponent(s.BoxCollider,{width:10,height:16,physics:!0,debug:!0},"BodyCollider"),this.edgeCollider=this.addComponent(s.BoxCollider,{width:4,height:4,offsetX:8,offsetY:-10,physics:!1,debug:!0},"EdgeCollider"),this.addComponent(s.RigidBody,{rigidBodyType:s.RigidBodyType.Dynamic,gravity:3e3}),this.transform.position=t,this.walkSpeed=e}start(){this.transform.scale.set(3,3),this.animator.playAnimation("Walking")}update(){this.move()}move(){this.bodyCollisions=this.bodyCollider.getCollisionsWithLayer(r.LAYERS.Foreground),this.bodyCollision=this.bodyCollisions.length>0,this.edgeCollision=this.edgeCollider.collidesWithLayer(r.LAYERS.Foreground),this.playerCollision=this.edgeCollider.collidesWithLayer(r.LAYERS.Player),this.wallCollision=this.bodyCollision&&this.bodyCollisions.some((t=>0!==t.resolution.direction.x));let t=this.bodyCollision?0:this.rigidBody.velocity.y;this.edgeCollision&&!this.wallCollision||!this.bodyCollision||(this.transform.scale.x*=-1),this.playerCollision&&!1===this.jumping&&(this.jumping=!0,t=this.jumpSpeed),!1===this.playerCollision&&(this.jumping=!1),this.cacheVelocity.set(Math.sign(this.transform.scale.x)*this.walkSpeed,t),this.rigidBody.velocity=this.cacheVelocity}}e.Goblin=n},766:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.InputController=void 0;const s=i(844);class o extends s.GameObject{constructor(){super(...arguments),this.axis=new s.Vector2(0,0),this.jump=!1,this.pause=!1}init(){this.keyboard=this.inputManager.keyboard}update(){this.gamepad=this.inputManager.gamepad.getGamepad(0),this.updateKeyboard(),this.gamepad&&this.updateGamepad()}updateKeyboard(){this.axis.x=this.keyboard.isPressed("ArrowRight")?1:this.keyboard.isPressed("ArrowLeft")?-1:0,this.axis.y=this.keyboard.isPressed("ArrowUp")?1:this.keyboard.isPressed("ArrowDown")?-1:0,this.jump=this.keyboard.isPressed("Space"),this.pause=this.keyboard.isPressed("KeyP")}updateGamepad(){this.gamepad.dpadAxes.magnitude>0?this.axis.copy(this.gamepad.dpadAxes):this.gamepad.leftStickAxes.magnitude>=.5&&this.axis.set(Math.sign(this.gamepad.leftStickAxes.x),Math.sign(this.gamepad.leftStickAxes.y)),this.jump=this.gamepad.bottomFace||this.jump,this.pause=this.gamepad.start||this.pause}}e.InputController=o},265:function(t,e,i){var s=this&&this.__createBinding||(Object.create?function(t,e,i,s){void 0===s&&(s=i);var o=Object.getOwnPropertyDescriptor(e,i);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,s,o)}:function(t,e,i,s){void 0===s&&(s=i),t[s]=e[i]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),r=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&s(e,t,i);return o(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Player=void 0;const n=i(844),a=r(i(926)),h=i(960),l=i(51),c=i(5);class d extends n.GameObject{constructor(){super(...arguments),this.grounded=!1}init(){this.layer=c.LAYERS.Player,this.spriteRenderer=this.addComponent(n.SpriteRenderer,{sprite:new n.Sprite({image:this.assetManager.getImage("image/player/player-spritesheet.png"),slice:new n.Rectangle(0,64,16,16),smooth:!1}),offset:new n.Vector2(0,0)}),this.animator=this.addComponent(n.Animator,{spriteRenderer:this.spriteRenderer}).addAnimation(a.NinjaIdle(this.assetManager),"PlayerIdle").addAnimation(a.NinjaRun(this.assetManager),"PlayerRun"),this.addComponent(n.BoxCollider,{width:8,height:16,physics:!0,debug:!0},"BodyCollider"),this.addComponent(n.BoxCollider,{width:6,height:6,offsetY:-6,physics:!1,debug:!0},"FeetCollider"),this.addComponent(n.BoxCollider,{width:6,height:4,offsetY:6,physics:!1,debug:!0},"HeadCollider"),this.addComponent(n.RigidBody,{rigidBodyType:n.RigidBodyType.Dynamic}),this.movements=this.addComponent(l.Movements),this.addComponent(h.AnimationController)}start(){this.transform.scale.set(3,3),this.animator.playAnimation("PlayerIdle")}update(){this.grounded=this.movements.grounded}}e.Player=d},833:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Foreground=void 0;const o=i(844),r=i(5),n=s(i(434)),a=i(228);class h extends o.GameObject{init(){this.layer=r.LAYERS.Foreground,this.transform.scale.set(3,3),this.tilemapRenderer=this.addComponent(o.TiledTilemapRenderer,{tileset:{image:this.assetManager.getImage("image/tileset/tileset.png"),tileWidth:16,tileHeight:16,width:12},tiledData:n.default,tilemapLayer:"Layer1",tileWidth:16,tileHeight:16,orientation:o.TilemapOrientation.RightDown,smooth:!1}),this.addComponent(o.TilemapCollider,{tilemapRenderer:this.tilemapRenderer,debug:!0,composite:!1}),this.addComponent(o.RigidBody,{rigidBodyType:o.RigidBodyType.Static,gravity:0}),this.addChild(a.OtherLayer).transform.innerPosition=new o.Vector2(0,0)}}e.Foreground=h},68:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MovingPlatform=void 0;const s=i(844),o=i(5);class r extends s.GameObject{init({spots:t}){this.layer=o.LAYERS.Platform,this.addComponent(s.SpriteRenderer,{sprite:new s.Sprite({image:this.assetManager.getImage("image/tileset/tileset.png"),smooth:!1,slice:new s.Rectangle(96,48,48,16)})}),this.addComponent(s.BoxCollider,{debug:!0,width:48,height:2,offsetY:7}),this.addComponent(s.RigidBody,{rigidBodyType:s.RigidBodyType.Kinematic}),this.addComponent(n,{spots:t}),this.transform.scale.set(3,3)}}e.MovingPlatform=r;class n extends s.PhysicsComponent{constructor(){super(...arguments),this.moveSpeed=150,this.center=new s.Rectangle(0,0,4,4),this.currentSpotIndex=0,this.direction=new s.Vector2,this.velocity=new s.Vector2}init({spots:t}){this.spots=t.map((t=>new s.Rectangle(t.x-2,t.y-2,4,4)))}start(){this.currentSpot=this.spots[this.currentSpotIndex],this.gameObject.transform.position=this.currentSpot.center,this.center.position=this.gameObject.transform.position}update(){s.Vector2.unit(this.direction,s.Vector2.subtract(this.direction,this.currentSpot.center,this.gameObject.transform.position)),s.Vector2.add(this.gameObject.transform.position,this.gameObject.transform.position,s.Vector2.scale(this.velocity,this.direction,this.moveSpeed*this.timeManager.physicsDeltaTime)),this.center.position=this.gameObject.transform.position,this.center.overlaps(this.currentSpot)&&(this.gameObject.transform.position=this.currentSpot.center,this.currentSpotIndex=(this.currentSpotIndex+1)%this.spots.length,this.currentSpot=this.spots[this.currentSpotIndex])}}},228:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.OtherLayer=void 0;const o=i(844),r=i(5),n=s(i(434));class a extends o.GameObject{init(){this.layer=r.LAYERS.Overlayer,this.addComponent(o.TiledTilemapRenderer,{tileset:{image:this.assetManager.getImage("image/tileset/tileset.png"),tileWidth:16,tileHeight:16,width:12},tiledData:n.default,tilemapLayer:"Layer2",tileWidth:16,tileHeight:16,orientation:o.TilemapOrientation.RightDown}),this.transform.scale.set(3,3)}}e.OtherLayer=a},158:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Parallax=void 0;const s=i(844),o=i(5);class r extends s.GameObject{init(){this.layer=o.LAYERS.Parallax,this.addComponent(s.SpriteRenderer,{sprite:new s.Sprite({image:this.assetManager.getImage("image/scene/background.png"),smooth:!1}),tiled:new s.Vector2(6,1)}),this.transform.scale.set(4.8,9.6),this.transform.position.set(1512,-500)}}e.Parallax=r},309:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.WoodenPlate=void 0;const s=i(844),o=i(5);class r extends s.GameObject{constructor(){super(...arguments),this.direction=1}init(){this.layer=o.LAYERS.Foreground,this.addComponent(s.SpriteRenderer,{sprite:new s.Sprite({image:this.assetManager.getImage("image/misc/wooden_plate.png"),smooth:!1}),tiled:new s.Vector2(3,1),offset:new s.Vector2(0,0)}),this.addComponent(s.BoxCollider,{width:48,height:8,physics:!0,debug:!0,offsetY:4}),this.addComponent(s.RigidBody,{rigidBodyType:s.RigidBodyType.Kinematic}),this.transform.scale.set(3,3),this.transform.position.set(1400,-648)}update(){this.direction=-1,this.transform.rotation.degrees+=100*this.timeManager.deltaTime*this.direction}}e.WoodenPlate=r},620:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.FpsMetter=void 0;const s=i(844),o=i(5),r=.1;class n extends s.GameObject{init(){this.layer=o.LAYERS.UI,this.ui=!0,this.addComponent(h),this.addComponent(a),this.addComponent(l),this.transform.position.set(20-this.domManager.canvas.width/2,40-this.domManager.canvas.height/2)}}e.FpsMetter=n;class a extends s.PhysicsComponent{constructor(){super(...arguments),this.timer=r,this.counter=0}init(){this.textRenderer=this.gameObject.addComponent(s.TextRenderer,{width:280,text:"",color:"#A7D6ED",fontSize:14,font:"PressStart2P-Regular",bitmapSpacing:new s.Vector2(-1,-2),orientation:s.TextOrientation.RightDown,offset:new s.Vector2(260,0)})}update(){if(this.timer+=this.timeManager.unscaledPhysicsDeltaTime,this.counter++,this.timer>=r){const t=(1/(this.timer/this.counter)).toFixed(2);this.textRenderer.text=`Physics: ${t} FPS`,this.timer=0,this.counter=0}}}class h extends s.Component{constructor(){super(...arguments),this.timer=r,this.counter=0}init(){this.textRenderer=this.gameObject.addComponent(s.TextRenderer,{width:210,text:"",color:"#A7D6ED",fontSize:14,font:"PressStart2P-Regular",bitmapSpacing:new s.Vector2(-1,-2),orientation:s.TextOrientation.RightDown,smooth:!1})}update(){if(this.timer+=this.timeManager.unscaledDeltaTime,this.counter++,this.timer>=r){const t=(1/(this.timer/this.counter)).toFixed(2);this.textRenderer.text=`Game: ${t} FPS`,this.timer=0,this.counter=0}}}class l extends s.PreRenderComponent{constructor(){super(...arguments),this.timer=r,this.counter=0}init(){this.textRenderer=this.gameObject.addComponent(s.TextRenderer,{width:280,text:"",color:"#A7D6ED",fontSize:14,font:"PressStart2P-Regular",bitmapSpacing:new s.Vector2(-1,-2),orientation:s.TextOrientation.RightDown,offset:new s.Vector2(580,0)})}update(){if(this.timer+=this.timeManager.browserDeltaTime,this.counter++,this.timer>=r){const t=(1/(this.timer/this.counter)).toFixed(2);this.textRenderer.text=`Render: ${t} FPS`,this.timer=0,this.counter=0}}}},776:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Information=void 0;const s=i(844),o=i(5),r="Use Arrows to move and Space to jump";class n extends s.GameObject{init(){this.layer=o.LAYERS.UI,this.ui=!0,this.addComponent(s.TextRenderer,{width:504,text:r,color:"#A7D6ED",fontSize:14,font:"PressStart2P-Regular",orientation:s.TextOrientation.RightDown,bitmapSpacing:new s.Vector2(-1,-2)}),this.transform.position.set(20-this.domManager.canvas.width/2,70-this.domManager.canvas.height/2)}}e.Information=n},130:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Pause=void 0;const s=i(844),o=i(5);class r extends s.GameObject{init(){this.layer=o.LAYERS.UI,this.ui=!0,this.addComponent(s.TextRenderer,{text:"PAUSE",color:"#A7D6ED",fontSize:20,font:"PressStart2P-Regular",bitmapSpacing:new s.Vector2(-1,-2),orientation:s.TextOrientation.Center,width:100})}}e.Pause=r},324:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GameScene=void 0;const s=i(844),o=i(5),r=i(214),n=i(122),a=i(833),h=i(766),l=i(68),c=i(158),d=i(309),u=i(620),p=i(776);class g extends s.Scene{init(){this.setupCamera(),this.setupStage(),this.addGameObject(h.InputController),this.addGameObject(n.GameController),this.addGameObject(u.FpsMetter),this.addGameObject(p.Information)}setupCamera(){this.gameCamera.layers=[o.LAYERS.Background,o.LAYERS.Foreground,o.LAYERS.Hills,o.LAYERS.Platform,o.LAYERS.Goblin,o.LAYERS.Player,o.LAYERS.Overlayer,o.LAYERS.UI],this.gameCamera.addComponent(r.FollowPlayerCamera);const t=this.gameCamera.addChild(s.GameCamera);t.layers=[o.LAYERS.Parallax],t.zoom=.6,t.depth=-1}setupStage(){this.addGameObject(a.Foreground),this.addGameObject(d.WoodenPlate),this.addGameObject(l.MovingPlatform,{spots:[new s.Vector2(1992,-688),new s.Vector2(1992,-824),new s.Vector2(2448,-824)]}),this.addGameObject(l.MovingPlatform,{spots:[new s.Vector2(2184,-688),new s.Vector2(2948,-688)]}),this.addGameObject(c.Parallax)}}e.GameScene=g},969:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Loading=void 0;const s=i(844),o=i(904);class r extends s.Scene{init(){Object.values(o.ASSETS.fonts).forEach((t=>this.assetManager.loadFont(t.name,t.url))),Object.values(o.ASSETS.images).forEach((t=>this.assetManager.loadImage(t)))}update(){this.assetManager.getAssetsLoaded()&&this.sceneManager.loadScene("GameScene")}}e.Loading=r},434:t=>{t.exports=JSON.parse('{"compressionlevel":-1,"height":22,"infinite":false,"layers":[{"data":[1,2,2,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,3,13,14,14,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,13,15,13,14,14,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,13,15,13,14,14,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,13,15,13,14,14,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,45,0,0,0,13,15,13,14,14,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,30,15,0,0,0,0,13,15,13,14,14,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,30,14,14,15,0,0,0,43,30,15,13,14,14,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,30,14,14,14,14,15,0,0,0,0,13,15,13,14,14,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,30,14,14,14,14,14,14,28,45,0,0,0,13,15,13,14,14,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,30,14,14,14,14,14,14,14,14,15,0,0,0,0,13,15,13,14,14,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,30,14,14,14,14,14,14,14,14,14,14,15,0,0,0,43,30,15,13,14,14,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,30,14,14,14,14,14,14,14,14,14,14,14,14,15,0,0,0,0,13,15,13,14,14,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,30,14,14,14,14,14,14,14,14,14,14,14,14,14,14,28,45,0,0,0,13,15,13,14,14,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,30,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,0,0,0,0,13,15,13,14,14,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,2,2,2,3,0,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,0,0,0,43,30,15,13,14,14,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,30,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,13,14,14,14,14,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,13,15,13,14,14,15,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,30,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,13,14,14,14,14,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,30,15,13,14,14,15,0,0,0,0,0,0,0,0,0,0,0,1,2,30,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,13,14,14,28,2,2,2,2,2,2,2,2,2,2,2,30,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,28,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,30,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,25,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15],"height":22,"id":1,"name":"Layer1","opacity":1,"type":"tilelayer","visible":true,"width":96,"x":0,"y":0},{"data":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,8,8,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,20,20,21,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,20,20,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,36,20,20,10,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,20,20,34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,20,20,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,36,20,20,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,20,20,10,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,20,20,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,20,20,34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,20,20,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,31,20,20,32,12,34,35,36,20,10,11,12,20,35,36,20,10,32,20,35,36,20,10,33,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"height":22,"id":3,"name":"Layer2","opacity":0.7,"type":"tilelayer","visible":true,"width":96,"x":0,"y":0},{"data":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,463,464,465,466,0,0,0,0,0,463,464,465,466,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,463,464,527,528,529,530,465,466,0,463,464,527,528,529,530,465,466,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,527,528,1313,1235,1235,1305,529,530,459,527,528,1313,1235,1235,1305,529,530,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"height":22,"id":5,"name":"Hills","opacity":1,"type":"tilelayer","visible":false,"width":96,"x":0,"y":0}],"nextlayerid":6,"nextobjectid":1,"orientation":"orthogonal","renderorder":"right-down","tiledversion":"1.7.2","tileheight":16,"tilesets":[{"firstgid":1,"source":"../../../../Tiled Projects/Mini Platformer/Tileset01.tsx"},{"firstgid":73,"source":"../../../../Tiled Projects/Mini Platformer/brinstar.tsx"}],"tilewidth":16,"type":"map","version":"1.6","width":96}')}},e={};function i(s){var o=e[s];if(void 0!==o)return o.exports;var r=e[s]={exports:{}};return t[s].call(r.exports,r,r.exports,i),r.exports}i.d=(t,e)=>{for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};(()=>{const t=i(844),e=i(920),s=i(324),o=i(969),r={containerNode:document.getElementById("app"),gameWidth:1280,gameHeight:720,collisions:{collisionMatrix:e.PARAMETERS.collisionMatrix}},n=new t.Game(r);n.addScene(o.Loading,"Loading"),n.addScene(s.GameScene,"GameScene"),n.run()})()})();